import numpy as np
import re
import matplotlib.pyplot as plt
from typing import List, Tuple

from geodata.ecoc.ecoc import (
  load_ecoc_codes,
  ecoc_prevalence_by_bit, 
  pos_weight_from_prevalence
)

def test():
  codes_path="python/geodata/countries.ecoc.json"
  PATH = "python/geodata/parquet/dataset_all.parquet"
  codebook = load_ecoc_codes(codes_path)

  ones_c1, totals_c1, p1_c1 = ecoc_prevalence_by_bit(PATH, codebook, id_col="c1_id")
  ones_c2, totals_c2, p1_c2 = ecoc_prevalence_by_bit(PATH, codebook, id_col="c2_id")

  np.set_printoptions(formatter={'all': lambda x: "{:.2g}".format(x)})
  pw_c1 = pos_weight_from_prevalence(p1_c1)
  pw_c2 = pos_weight_from_prevalence(p1_c2)
  print("c1: ", pw_c1)
  print("c2: ", pw_c2)
  print(codebook.get(289))

  # Stats of dataset_all (rounded to .2):
  '''
  c1:  
  [0.75 0.29 0.25 0.29 0.73 0.24 0.27 0.77
  0.81 0.8  0.26 0.23 0.73 0.72 0.27 0.72 
  0.26 0.72 0.77 0.78 0.74 0.23 0.69 0.3 
  0.2  0.71 0.2  0.77 0.77 0.19 0.79 0.21]
  c2:  
  [0.66 0.39 0.34 0.37 0.61 0.35 0.36 0.69
  0.75 0.69 0.34 0.32 0.61 0.62 0.37 0.61
  0.4  0.64 0.66 0.66 0.67 0.32 0.6  0.4 
  0.29 0.6  0.31 0.67 0.65 0.31 0.67 0.31]
  '''
  # 289 -> [1 0 0 0 1 0 0 1 1 1 0 0 1 1 0 1 0 1 1 1 1 0 1 0 0 1 0 1 1 0 1 0]

edges = np.array([[0.01, 1.0],
                  [1.0 , 5.0],
                  [5.0 ,10.0],
                  [10.0,25.0],
                  [25.0,50.0],
                  [50.0,150.0],
                  [150.0,500.0]], dtype=float)

def find_rband_probs(edges, beta = 0.35):
  '''larger beta -> more near-border emphasis '''
  log_width = np.log(edges[:,1]/edges[:,0])          # ln(high/low)
  i = np.arange(len(edges))                           # 0..6 (0 is nearest)
  beta = 0.35                                         
  raw = log_width * np.exp(-beta * i)
  probs = raw / raw.sum()
  print(probs)
  


def extract_and_plot_train_losses(log_text: str) -> List[float]:
    '''
    Parse a training log like:
      [01] train: {'loss': 3.43, ...}  |  val: {...}
      [02] train: {'loss': 2.26, ...}  |  val: {...}
      ...
    Return the list of train losses ordered by epoch, print it, and plot it.
    '''
    # Regex: capture epoch number and the 'loss' value in the train dict
    pattern = re.compile(
        r"\[\s*(\d+)\s*\]\s*train:\s*\{.*?'loss'\s*:\s*([+-]?(?:\d+(?:\.\d+)?)(?:[eE][+-]?\d+)?)",
        re.DOTALL
    )
    matches = pattern.findall(log_text)

    # Convert & sort by epoch index just in case
    epoch_loss: List[Tuple[int, float]] = [(int(ep), float(loss)) for ep, loss in matches]
    epoch_loss.sort(key=lambda x: x[0])

    epochs = [ep for ep, _ in epoch_loss]
    losses = [ls for _, ls in epoch_loss]

    # Print the list of losses
    print(losses)

    # Plot
    plt.figure()
    plt.plot(epochs, losses, marker='o')
    plt.xlabel('Epoch')
    plt.ylabel('Train loss')
    plt.title('Train loss over epochs')
    plt.grid(True)
    plt.tight_layout()
    plt.show()

    return losses

printout = '''[01] train: {'loss': 3.4791963229200573, 'rmse_km': 227.6237472508086, 'rmse_log1p': 1.483923592443509, 'c1_loss': 0.6199132794676887, 'c2_loss': 0.6572536757998997}  |  val: {'rmse_km': 115.9651879000224, 'rmse_log1p': 1.124727693026627, 'c1_bit_acc': 0.676816875, 'c2_bit_acc': 0.63238125, 'c1_decoded_acc': 0.3856, 'c2_decoded_acc': 0.19378}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[02] train: {'loss': 2.270986710179647, 'rmse_km': 108.46303733876347, 'rmse_log1p': 1.0887226094283413, 'c1_loss': 0.5005503090922038, 'c2_loss': 0.5851193278757731}  |  val: {'rmse_km': 99.36219945073428, 'rmse_log1p': 1.0697643240629129, 'c1_bit_acc': 0.72901625, 'c2_bit_acc': 0.6624503125, 'c1_decoded_acc': 0.46766, 'c2_decoded_acc': 0.26008}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[03] train: {'loss': 2.0745593451944986, 'rmse_km': 98.32156863768499, 'rmse_log1p': 1.0413983698873728, 'c1_loss': 0.4393540864721934, 'c2_loss': 0.550694841870202}  |  val: {'rmse_km': 98.47089215378573, 'rmse_log1p': 1.027761628193029, 'c1_bit_acc': 0.752753125, 'c2_bit_acc': 0.6807453125, 'c1_decoded_acc': 0.51071, 'c2_decoded_acc': 0.2954}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[04] train: {'loss': 1.9553134476004705, 'rmse_km': 90.66081188970237, 'rmse_log1p': 1.0093168519457927, 'c1_loss': 0.40888460181660125, 'c2_loss': 0.5277081668980916}  |  val: {'rmse_km': 87.82211913507325, 'rmse_log1p': 0.9984852225729246, 'c1_bit_acc': 0.76307625, 'c2_bit_acc': 0.69502875, 'c1_decoded_acc': 0.52749, 'c2_decoded_acc': 0.32666}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[05] train: {'loss': 1.8730640904447768, 'rmse_km': 89.94527416018032, 'rmse_log1p': 0.9864398553091795, 'c1_loss': 0.39004571889135575, 'c2_loss': 0.5099549303605821}  |  val: {'rmse_km': 96.14156330803291, 'rmse_log1p': 0.9765687560834767, 'c1_bit_acc': 0.7705796875, 'c2_bit_acc': 0.705648125, 'c1_decoded_acc': 0.54146, 'c2_decoded_acc': 0.34957}
[06] train: {'loss': 1.8076393814468383, 'rmse_km': 88.31279303737652, 'rmse_log1p': 0.9671586717983683, 'c1_loss': 0.3769683280171288, 'c2_loss': 0.4952749626244439}  |  val: {'rmse_km': 86.51936538103767, 'rmse_log1p': 0.9630607470171448, 'c1_bit_acc': 0.7817746875, 'c2_bit_acc': 0.7145525, 'c1_decoded_acc': 0.56162, 'c2_decoded_acc': 0.36995}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[07] train: {'loss': 1.7577069417360094, 'rmse_km': 87.73355826645668, 'rmse_log1p': 0.9529564505210407, 'c1_loss': 0.36685895013597275, 'c2_loss': 0.4827219894674089}  |  val: {'rmse_km': 84.52454917988324, 'rmse_log1p': 0.9438614861530423, 'c1_bit_acc': 0.7877296875, 'c2_bit_acc': 0.72474, 'c1_decoded_acc': 0.57479, 'c2_decoded_acc': 0.39371}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[08] train: {'loss': 1.7101956650246515, 'rmse_km': 86.50227767503438, 'rmse_log1p': 0.9383765255646445, 'c1_loss': 0.3584896492693159, 'c2_loss': 0.47115546356625027}  |  val: {'rmse_km': 83.36003543552809, 'rmse_log1p': 0.9321091791206623, 'c1_bit_acc': 0.7898659375, 'c2_bit_acc': 0.732629375, 'c1_decoded_acc': 0.58032, 'c2_decoded_acc': 0.41033}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[09] train: {'loss': 1.6737185628170437, 'rmse_km': 85.3052280554583, 'rmse_log1p': 0.927941228995131, 'c1_loss': 0.35192573531468707, 'c2_loss': 0.46071780746036106}  |  val: {'rmse_km': 88.88793198812199, 'rmse_log1p': 0.9259498861091462, 'c1_bit_acc': 0.79348375, 'c2_bit_acc': 0.737978125, 'c1_decoded_acc': 0.58535, 'c2_decoded_acc': 0.43173}
[10] train: {'loss': 1.6434860292816162, 'rmse_km': 85.17178757333616, 'rmse_log1p': 0.9191899394607778, 'c1_loss': 0.3467235206434462, 'c2_loss': 0.4518524012184143}  |  val: {'rmse_km': 84.09915557691409, 'rmse_log1p': 0.9141165562483198, 'c1_bit_acc': 0.79911875, 'c2_bit_acc': 0.7438396875, 'c1_decoded_acc': 0.59578, 'c2_decoded_acc': 0.44989}
[11] train: {'loss': 1.612124271774292, 'rmse_km': 83.9694855987504, 'rmse_log1p': 0.9092287896456377, 'c1_loss': 0.34165019205623204, 'c2_loss': 0.44377696144209966}  |  val: {'rmse_km': 82.066346658702, 'rmse_log1p': 0.9037036968837309, 'c1_bit_acc': 0.8018690625, 'c2_bit_acc': 0.7491, 'c1_decoded_acc': 0.60358, 'c2_decoded_acc': 0.46355}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[12] train: {'loss': 1.5843103362528483, 'rmse_km': 83.08164106486613, 'rmse_log1p': 0.9002757630140445, 'c1_loss': 0.337491829761929, 'c2_loss': 0.43632205026838516}  |  val: {'rmse_km': 82.51431279727323, 'rmse_log1p': 0.898038493578188, 'c1_bit_acc': 0.802941875, 'c2_bit_acc': 0.75453125, 'c1_decoded_acc': 0.60547, 'c2_decoded_acc': 0.47981}
[13] train: {'loss': 1.5623625716484917, 'rmse_km': 83.77816107696265, 'rmse_log1p': 0.8936390654534437, 'c1_loss': 0.3338775415897369, 'c2_loss': 0.42989418562677173}  |  val: {'rmse_km': 83.3009797220672, 'rmse_log1p': 0.8967897647137466, 'c1_bit_acc': 0.80594125, 'c2_bit_acc': 0.7567584375, 'c1_decoded_acc': 0.61279, 'c2_decoded_acc': 0.48631}
[14] train: {'loss': 1.544133713590834, 'rmse_km': 84.46128978802213, 'rmse_log1p': 0.8883889890368858, 'c1_loss': 0.3308082512908512, 'c2_loss': 0.424090457695855}  |  val: {'rmse_km': 80.2618699846789, 'rmse_log1p': 0.8876534799385865, 'c1_bit_acc': 0.8068653125, 'c2_bit_acc': 0.761836875, 'c1_decoded_acc': 0.6142, 'c2_decoded_acc': 0.4986}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[15] train: {'loss': 1.5235623502053155, 'rmse_km': 83.95093374908792, 'rmse_log1p': 0.8817734131134083, 'c1_loss': 0.3276210614204407, 'c2_loss': 0.418416845009062}  |  val: {'rmse_km': 83.85400200553191, 'rmse_log1p': 0.8838069344921208, 'c1_bit_acc': 0.807883125, 'c2_bit_acc': 0.765135, 'c1_decoded_acc': 0.61515, 'c2_decoded_acc': 0.50801}
[16] train: {'loss': 1.5077063037194145, 'rmse_km': 83.54656086297777, 'rmse_log1p': 0.8769532269518141, 'c1_loss': 0.3251854274103377, 'c2_loss': 0.4134740043120914}  |  val: {'rmse_km': 87.09709414552101, 'rmse_log1p': 0.877978738299253, 'c1_bit_acc': 0.81073125, 'c2_bit_acc': 0.7681546875, 'c1_decoded_acc': 0.62093, 'c2_decoded_acc': 0.51456}
[17] train: {'loss': 1.4882198791207208, 'rmse_km': 83.57879247022686, 'rmse_log1p': 0.8702450710727992, 'c1_loss': 0.32238368561638725, 'c2_loss': 0.4085096701886919}  |  val: {'rmse_km': 81.74515586756502, 'rmse_log1p': 0.8693719106107842, 'c1_bit_acc': 0.8111990625, 'c2_bit_acc': 0.7716425, 'c1_decoded_acc': 0.62176, 'c2_decoded_acc': 0.52172}
[18] train: {'loss': 1.4709878237406413, 'rmse_km': 81.39965784249341, 'rmse_log1p': 0.8641900504751843, 'c1_loss': 0.31996185061136884, 'c2_loss': 0.40420161521381803}  |  val: {'rmse_km': 82.2030195660795, 'rmse_log1p': 0.8692011094210444, 'c1_bit_acc': 0.813903125, 'c2_bit_acc': 0.77346125, 'c1_decoded_acc': 0.62774, 'c2_decoded_acc': 0.52494}
[19] train: {'loss': 1.4597652090115016, 'rmse_km': 81.90878358347778, 'rmse_log1p': 0.861055880402409, 'c1_loss': 0.31796681140369837, 'c2_loss': 0.4003810644817352}  |  val: {'rmse_km': 82.466781309393, 'rmse_log1p': 0.8580543079972953, 'c1_bit_acc': 0.81424375, 'c2_bit_acc': 0.7768690625, 'c1_decoded_acc': 0.62749, 'c2_decoded_acc': 0.53441}
[20] train: {'loss': 1.4460473714023165, 'rmse_km': 80.98005939446605, 'rmse_log1p': 0.8563684757436828, 'c1_loss': 0.3159891852792104, 'c2_loss': 0.3966913059298197}  |  val: {'rmse_km': 78.51943554186123, 'rmse_log1p': 0.8625393609726703, 'c1_bit_acc': 0.815748125, 'c2_bit_acc': 0.7782028125, 'c1_decoded_acc': 0.62918, 'c2_decoded_acc': 0.53894}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[21] train: {'loss': 1.432942520306905, 'rmse_km': 81.76184332216037, 'rmse_log1p': 0.851735578674103, 'c1_loss': 0.3142850920083788, 'c2_loss': 0.39320394113222756}  |  val: {'rmse_km': 81.29662724592269, 'rmse_log1p': 0.8504212107171745, 'c1_bit_acc': 0.8168425, 'c2_bit_acc': 0.778939375, 'c1_decoded_acc': 0.6333, 'c2_decoded_acc': 0.54297}
[22] train: {'loss': 1.425876715604994, 'rmse_km': 80.96708255230178, 'rmse_log1p': 0.849998542840494, 'c1_loss': 0.31315735825008817, 'c2_loss': 0.3902220091056824}  |  val: {'rmse_km': 85.07119031655193, 'rmse_log1p': 0.8488909259707068, 'c1_bit_acc': 0.8167259375, 'c2_bit_acc': 0.7830559375, 'c1_decoded_acc': 0.63349, 'c2_decoded_acc': 0.55029}
[23] train: {'loss': 1.4064201548088922, 'rmse_km': 79.88588051871244, 'rmse_log1p': 0.8422216772954493, 'c1_loss': 0.31057697631412085, 'c2_loss': 0.38650582537015277}  |  val: {'rmse_km': 80.88614140317085, 'rmse_log1p': 0.8423679476973595, 'c1_bit_acc': 0.8176690625, 'c2_bit_acc': 0.7836740625, 'c1_decoded_acc': 0.63519, 'c2_decoded_acc': 0.552}
[24] train: {'loss': 1.3993259456041125, 'rmse_km': 79.56493024568047, 'rmse_log1p': 0.8402305954086017, 'c1_loss': 0.30936524858898584, 'c2_loss': 0.3839731142648061}  |  val: {'rmse_km': 82.23650511444112, 'rmse_log1p': 0.8421006506476694, 'c1_bit_acc': 0.8178546875, 'c2_bit_acc': 0.7872084375, 'c1_decoded_acc': 0.63595, 'c2_decoded_acc': 0.55841}
[25] train: {'loss': 1.3894369825024075, 'rmse_km': 79.73773232937623, 'rmse_log1p': 0.8364342969114634, 'c1_loss': 0.3083288421196408, 'c2_loss': 0.38148594636387295}  |  val: {'rmse_km': 77.29233771047426, 'rmse_log1p': 0.8368879601270611, 'c1_bit_acc': 0.819285625, 'c2_bit_acc': 0.78827625, 'c1_decoded_acc': 0.6383, 'c2_decoded_acc': 0.56193}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[26] train: {'loss': 1.3845676008817884, 'rmse_km': 79.0799480500193, 'rmse_log1p': 0.835280864614586, 'c1_loss': 0.30736031141493053, 'c2_loss': 0.3795132802963257}  |  val: {'rmse_km': 77.31348839808776, 'rmse_log1p': 0.8358334628099041, 'c1_bit_acc': 0.8191690625, 'c2_bit_acc': 0.78925, 'c1_decoded_acc': 0.63796, 'c2_decoded_acc': 0.56235}
[27] train: {'loss': 1.3724142559221055, 'rmse_km': 79.44573619773436, 'rmse_log1p': 0.8305021033492946, 'c1_loss': 0.30579839077419707, 'c2_loss': 0.37688224767367046}  |  val: {'rmse_km': 79.574911271746, 'rmse_log1p': 0.8321537769344913, 'c1_bit_acc': 0.82341, 'c2_bit_acc': 0.788658125, 'c1_decoded_acc': 0.64536, 'c2_decoded_acc': 0.56537}
[28] train: {'loss': 1.3610754451709324, 'rmse_km': 78.55501344101947, 'rmse_log1p': 0.825699583290164, 'c1_loss': 0.30458603764957853, 'c2_loss': 0.37470954438527426}  |  val: {'rmse_km': 77.64312955056776, 'rmse_log1p': 0.8331268332848264, 'c1_bit_acc': 0.8225284375, 'c2_bit_acc': 0.79086875, 'c1_decoded_acc': 0.64439, 'c2_decoded_acc': 0.56888}
[29] train: {'loss': 1.3565187533399794, 'rmse_km': 79.11245642576617, 'rmse_log1p': 0.8246581727682398, 'c1_loss': 0.30372930816544425, 'c2_loss': 0.37272857757780287}  |  val: {'rmse_km': 77.88301899924977, 'rmse_log1p': 0.8296519902275958, 'c1_bit_acc': 0.8216759375, 'c2_bit_acc': 0.793448125, 'c1_decoded_acc': 0.64518, 'c2_decoded_acc': 0.57441}
[30] train: {'loss': 1.348093085623847, 'rmse_km': 78.64237437205848, 'rmse_log1p': 0.8213555017693086, 'c1_loss': 0.30269137018415665, 'c2_loss': 0.3707767646238539}  |  val: {'rmse_km': 81.63940339995142, 'rmse_log1p': 0.8306472084170717, 'c1_bit_acc': 0.8229240625, 'c2_bit_acc': 0.7939328125, 'c1_decoded_acc': 0.64541, 'c2_decoded_acc': 0.57715}
[31] train: {'loss': 1.344234378751119, 'rmse_km': 77.94935567906414, 'rmse_log1p': 0.8202170543547757, 'c1_loss': 0.3021265672545963, 'c2_loss': 0.36935165142801074}  |  val: {'rmse_km': 82.39171693520684, 'rmse_log1p': 0.8266877712227104, 'c1_bit_acc': 0.8251290625, 'c2_bit_acc': 0.7943496875, 'c1_decoded_acc': 0.64931, 'c2_decoded_acc': 0.57552}
[32] train: {'loss': 1.333823538148668, 'rmse_km': 78.84401010658641, 'rmse_log1p': 0.8160382404179177, 'c1_loss': 0.30073249430762394, 'c2_loss': 0.36717260755115083}  |  val: {'rmse_km': 78.76728790894892, 'rmse_log1p': 0.8232740439046937, 'c1_bit_acc': 0.82476, 'c2_bit_acc': 0.7961553125, 'c1_decoded_acc': 0.64951, 'c2_decoded_acc': 0.58029}
[33] train: {'loss': 1.3262776053322687, 'rmse_km': 79.93184657979728, 'rmse_log1p': 0.8130411766646508, 'c1_loss': 0.29990459221839905, 'c2_loss': 0.365337050125334}  |  val: {'rmse_km': 80.77684042606984, 'rmse_log1p': 0.8147185919842236, 'c1_bit_acc': 0.823521875, 'c2_bit_acc': 0.79801875, 'c1_decoded_acc': 0.64957, 'c2_decoded_acc': 0.58381}
[34] train: {'loss': 1.320538328145345, 'rmse_km': 78.59406374191852, 'rmse_log1p': 0.8109782714002575, 'c1_loss': 0.299073119702869, 'c2_loss': 0.3637795682144165}  |  val: {'rmse_km': 82.27484961339188, 'rmse_log1p': 0.8207781242225395, 'c1_bit_acc': 0.824396875, 'c2_bit_acc': 0.795089375, 'c1_decoded_acc': 0.64944, 'c2_decoded_acc': 0.57933}
[35] train: {'loss': 1.3217620028262669, 'rmse_km': 78.66562630347991, 'rmse_log1p': 0.8124604582334651, 'c1_loss': 0.2989071457364824, 'c2_loss': 0.36276287038379246}  |  val: {'rmse_km': 85.17649128702561, 'rmse_log1p': 0.8121075415946079, 'c1_bit_acc': 0.8247878125, 'c2_bit_acc': 0.79935125, 'c1_decoded_acc': 0.64998, 'c2_decoded_acc': 0.58562}
[36] train: {'loss': 1.3062632516649035, 'rmse_km': 77.61166036246583, 'rmse_log1p': 0.8054165176638804, 'c1_loss': 0.29712130430115596, 'c2_loss': 0.3604461281257206}  |  val: {'rmse_km': 74.16726174562298, 'rmse_log1p': 0.804582088936374, 'c1_bit_acc': 0.8284521875, 'c2_bit_acc': 0.798999375, 'c1_decoded_acc': 0.65634, 'c2_decoded_acc': 0.58832}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[37] train: {'loss': 1.301418020125495, 'rmse_km': 77.11728207939191, 'rmse_log1p': 0.8034204303318426, 'c1_loss': 0.29674190430323283, 'c2_loss': 0.3591918091307746}  |  val: {'rmse_km': 77.08784052138184, 'rmse_log1p': 0.8106063637102242, 'c1_bit_acc': 0.8263453125, 'c2_bit_acc': 0.8000634375, 'c1_decoded_acc': 0.65329, 'c2_decoded_acc': 0.58913}
[38] train: {'loss': 1.3001506270429823, 'rmse_km': 78.01839914705216, 'rmse_log1p': 0.8034573012248442, 'c1_loss': 0.29639463324652776, 'c2_loss': 0.3582125132030911}  |  val: {'rmse_km': 74.6577510052121, 'rmse_log1p': 0.8071311955266611, 'c1_bit_acc': 0.826760625, 'c2_bit_acc': 0.8013353125, 'c1_decoded_acc': 0.65346, 'c2_decoded_acc': 0.59299}
[39] train: {'loss': 1.2902155948003133, 'rmse_km': 77.73329616085536, 'rmse_log1p': 0.7988226034631148, 'c1_loss': 0.2954505416594611, 'c2_loss': 0.3566476707786984}  |  val: {'rmse_km': 79.2505791579784, 'rmse_log1p': 0.8071398356413682, 'c1_bit_acc': 0.82672375, 'c2_bit_acc': 0.802425625, 'c1_decoded_acc': 0.65286, 'c2_decoded_acc': 0.59399}
[40] train: {'loss': 1.2841890396330091, 'rmse_km': 77.04541261794078, 'rmse_log1p': 0.7965983490268111, 'c1_loss': 0.2945423729218377, 'c2_loss': 0.3550776875983344}  |  val: {'rmse_km': 74.90509946446403, 'rmse_log1p': 0.8019012434389745, 'c1_bit_acc': 0.827559375, 'c2_bit_acc': 0.8027253125, 'c1_decoded_acc': 0.65597, 'c2_decoded_acc': 0.59436}
[41] train: {'loss': 1.2843577397706774, 'rmse_km': 77.99441586581696, 'rmse_log1p': 0.7973827539555233, 'c1_loss': 0.2942310308127933, 'c2_loss': 0.35430741215493944}  |  val: {'rmse_km': 78.3254148119801, 'rmse_log1p': 0.798197042310048, 'c1_bit_acc': 0.8279809375, 'c2_bit_acc': 0.8034446875, 'c1_decoded_acc': 0.65628, 'c2_decoded_acc': 0.59649}
[42] train: {'loss': 1.2769401613871256, 'rmse_km': 79.21721213990524, 'rmse_log1p': 0.7937904572877053, 'c1_loss': 0.293776776131524, 'c2_loss': 0.3530603595998552}  |  val: {'rmse_km': 78.58457016468786, 'rmse_log1p': 0.7994105820122208, 'c1_bit_acc': 0.8285078125, 'c2_bit_acc': 0.803055625, 'c1_decoded_acc': 0.65684, 'c2_decoded_acc': 0.59608}
[43] train: {'loss': 1.272858859079149, 'rmse_km': 77.01636202477529, 'rmse_log1p': 0.7927491583986606, 'c1_loss': 0.29290984313964846, 'c2_loss': 0.3514977207406362}  |  val: {'rmse_km': 77.90394037390695, 'rmse_log1p': 0.8003708695021069, 'c1_bit_acc': 0.8288615625, 'c2_bit_acc': 0.803035, 'c1_decoded_acc': 0.6567, 'c2_decoded_acc': 0.59625}
[44] train: {'loss': 1.2702712771436904, 'rmse_km': 76.47473604992861, 'rmse_log1p': 0.7916191906663904, 'c1_loss': 0.29279804752879673, 'c2_loss': 0.35081231424331666}  |  val: {'rmse_km': 78.09880810950318, 'rmse_log1p': 0.798165715910889, 'c1_bit_acc': 0.8306065625, 'c2_bit_acc': 0.8038334375, 'c1_decoded_acc': 0.6629, 'c2_decoded_acc': 0.59767}
[45] train: {'loss': 1.25794831808726, 'rmse_km': 76.33929837614765, 'rmse_log1p': 0.7856388411899681, 'c1_loss': 0.2915381145339542, 'c2_loss': 0.3491818225955963}  |  val: {'rmse_km': 76.89120129076863, 'rmse_log1p': 0.7911138402929568, 'c1_bit_acc': 0.8288465625, 'c2_bit_acc': 0.80553, 'c1_decoded_acc': 0.659, 'c2_decoded_acc': 0.60269}
[46] train: {'loss': 1.261280521214803, 'rmse_km': 77.07107869930847, 'rmse_log1p': 0.7882890215094605, 'c1_loss': 0.2913261451053619, 'c2_loss': 0.348554784784317}  |  val: {'rmse_km': 79.23579082002652, 'rmse_log1p': 0.799248656965314, 'c1_bit_acc': 0.8286715625, 'c2_bit_acc': 0.8052915625, 'c1_decoded_acc': 0.65845, 'c2_decoded_acc': 0.60318}
[47] train: {'loss': 1.2525542286554971, 'rmse_km': 77.07844016000843, 'rmse_log1p': 0.7840157571469347, 'c1_loss': 0.2906140942923228, 'c2_loss': 0.3472594361273448}  |  val: {'rmse_km': 78.84669472800525, 'rmse_log1p': 0.797877821379294, 'c1_bit_acc': 0.8289875, 'c2_bit_acc': 0.8067478125, 'c1_decoded_acc': 0.65978, 'c2_decoded_acc': 0.60392}
[48] train: {'loss': 1.2497453070407443, 'rmse_km': 77.33990520746713, 'rmse_log1p': 0.782909766453221, 'c1_loss': 0.29028164261288114, 'c2_loss': 0.34651590392218695}  |  val: {'rmse_km': 76.60326402049556, 'rmse_log1p': 0.7871708999706802, 'c1_bit_acc': 0.8304678125, 'c2_bit_acc': 0.807663125, 'c1_decoded_acc': 0.66168, 'c2_decoded_acc': 0.60738}
[49] train: {'loss': 1.2478989001846315, 'rmse_km': 77.97929537904596, 'rmse_log1p': 0.7825126362959448, 'c1_loss': 0.28992224587228566, 'c2_loss': 0.34565062085893417}  |  val: {'rmse_km': 76.41537522195713, 'rmse_log1p': 0.7846451039712771, 'c1_bit_acc': 0.8301196875, 'c2_bit_acc': 0.8083946875, 'c1_decoded_acc': 0.66227, 'c2_decoded_acc': 0.60934}
[50] train: {'loss': 1.2432343403922188, 'rmse_km': 76.49295629848052, 'rmse_log1p': 0.7804560250742751, 'c1_loss': 0.28933872476471795, 'c2_loss': 0.34478403059535556}  |  val: {'rmse_km': 75.6420112582122, 'rmse_log1p': 0.7885355936989861, 'c1_bit_acc': 0.8311159375, 'c2_bit_acc': 0.8080753125, 'c1_decoded_acc': 0.66434, 'c2_decoded_acc': 0.60701}
[51] train: {'loss': 1.238662054172092, 'rmse_km': 75.57471210249497, 'rmse_log1p': 0.778564108617927, 'c1_loss': 0.2888298329787784, 'c2_loss': 0.34367005571047465}  |  val: {'rmse_km': 73.95273379623974, 'rmse_log1p': 0.7830609884686693, 'c1_bit_acc': 0.831250625, 'c2_bit_acc': 0.808326875, 'c1_decoded_acc': 0.66308, 'c2_decoded_acc': 0.60708}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[52] train: {'loss': 1.2355179854244656, 'rmse_km': 77.01272913758316, 'rmse_log1p': 0.7773630724475078, 'c1_loss': 0.288395139269299, 'c2_loss': 0.34282944697909884}  |  val: {'rmse_km': 76.01191055929985, 'rmse_log1p': 0.796340838150912, 'c1_bit_acc': 0.8305015625, 'c2_bit_acc': 0.807758125, 'c1_decoded_acc': 0.66304, 'c2_decoded_acc': 0.60821}
[53] train: {'loss': 1.2345805699454413, 'rmse_km': 77.62493395226659, 'rmse_log1p': 0.7770778258659458, 'c1_loss': 0.28825343649758234, 'c2_loss': 0.3424772125360701}  |  val: {'rmse_km': 75.99899451945895, 'rmse_log1p': 0.7906778626994807, 'c1_bit_acc': 0.831884375, 'c2_bit_acc': 0.80877375, 'c1_decoded_acc': 0.66514, 'c2_decoded_acc': 0.60858}
[54] train: {'loss': 1.2341992821121215, 'rmse_km': 79.24641713608413, 'rmse_log1p': 0.7774899982532769, 'c1_loss': 0.2879171868387858, 'c2_loss': 0.34179140695254007}  |  val: {'rmse_km': 77.40115609500772, 'rmse_log1p': 0.7834764037118076, 'c1_bit_acc': 0.8306546875, 'c2_bit_acc': 0.809994375, 'c1_decoded_acc': 0.66268, 'c2_decoded_acc': 0.61301}
[55] train: {'loss': 1.221700688243442, 'rmse_km': 76.4947627649681, 'rmse_log1p': 0.7712685584953047, 'c1_loss': 0.28663851617813113, 'c2_loss': 0.34020708746592204}  |  val: {'rmse_km': 79.34511925265946, 'rmse_log1p': 0.77816311386707, 'c1_bit_acc': 0.8317871875, 'c2_bit_acc': 0.8097334375, 'c1_decoded_acc': 0.66547, 'c2_decoded_acc': 0.61209}
[56] train: {'loss': 1.2217450407918293, 'rmse_km': 76.33417484980106, 'rmse_log1p': 0.771504269114047, 'c1_loss': 0.28670079255104064, 'c2_loss': 0.33982551761203345}  |  val: {'rmse_km': 76.75523572328795, 'rmse_log1p': 0.7766036531224414, 'c1_bit_acc': 0.8313709375, 'c2_bit_acc': 0.8107803125, 'c1_decoded_acc': 0.66532, 'c2_decoded_acc': 0.61456}
[57] train: {'loss': 1.218181825290256, 'rmse_km': 76.6254747385375, 'rmse_log1p': 0.7701717751119007, 'c1_loss': 0.28608695251782734, 'c2_loss': 0.33893025738716126}  |  val: {'rmse_km': 75.32210778964567, 'rmse_log1p': 0.773690230567749, 'c1_bit_acc': 0.8318396875, 'c2_bit_acc': 0.8099928125, 'c1_decoded_acc': 0.66668, 'c2_decoded_acc': 0.61222}
[58] train: {'loss': 1.2144252346928914, 'rmse_km': 75.91570867889432, 'rmse_log1p': 0.7684130992637669, 'c1_loss': 0.28570994675742256, 'c2_loss': 0.3382565937688616}  |  val: {'rmse_km': 76.19019491234585, 'rmse_log1p': 0.7682147698211816, 'c1_bit_acc': 0.8335896875, 'c2_bit_acc': 0.8116596875, 'c1_decoded_acc': 0.66928, 'c2_decoded_acc': 0.61581}
[59] train: {'loss': 1.2095039763302273, 'rmse_km': 75.99128753515103, 'rmse_log1p': 0.7660816543498736, 'c1_loss': 0.2852526273197598, 'c2_loss': 0.3373703702184889}  |  val: {'rmse_km': 85.97868899289811, 'rmse_log1p': 0.7741506352183088, 'c1_bit_acc': 0.8327171875, 'c2_bit_acc': 0.81292625, 'c1_decoded_acc': 0.66767, 'c2_decoded_acc': 0.62036}
[60] train: {'loss': 1.2065072009616429, 'rmse_km': 75.94500027260682, 'rmse_log1p': 0.7647572874736461, 'c1_loss': 0.28480550267855326, 'c2_loss': 0.3368479379049937}  |  val: {'rmse_km': 76.87194163123662, 'rmse_log1p': 0.7734573824089819, 'c1_bit_acc': 0.8337328125, 'c2_bit_acc': 0.8126409375, 'c1_decoded_acc': 0.66942, 'c2_decoded_acc': 0.61837}
[61] train: {'loss': 1.20978011557685, 'rmse_km': 75.61654782312864, 'rmse_log1p': 0.7667181424468335, 'c1_loss': 0.2851855333105723, 'c2_loss': 0.336737836250729}  |  val: {'rmse_km': 79.0214783648645, 'rmse_log1p': 0.7703606255839954, 'c1_bit_acc': 0.8332609375, 'c2_bit_acc': 0.8131428125, 'c1_decoded_acc': 0.66779, 'c2_decoded_acc': 0.62001}
[62] train: {'loss': 1.2023632611465453, 'rmse_km': 76.33667908822567, 'rmse_log1p': 0.7631424339358753, 'c1_loss': 0.2842393046813541, 'c2_loss': 0.33573759631792705}  |  val: {'rmse_km': 84.9344789979679, 'rmse_log1p': 0.7676322859663847, 'c1_bit_acc': 0.8329903125, 'c2_bit_acc': 0.81418625, 'c1_decoded_acc': 0.66713, 'c2_decoded_acc': 0.62185}
[63] train: {'loss': 1.195414426820543, 'rmse_km': 74.93771502262729, 'rmse_log1p': 0.7598695267186668, 'c1_loss': 0.2834905116685231, 'c2_loss': 0.33452224765989513}  |  val: {'rmse_km': 72.5790416384527, 'rmse_log1p': 0.7668104919685887, 'c1_bit_acc': 0.8339053125, 'c2_bit_acc': 0.813558125, 'c1_decoded_acc': 0.67083, 'c2_decoded_acc': 0.61848}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[64] train: {'loss': 1.1995265301683213, 'rmse_km': 75.25368878521006, 'rmse_log1p': 0.7624686828810874, 'c1_loss': 0.28376508290396796, 'c2_loss': 0.334403015411165}  |  val: {'rmse_km': 75.81221017050947, 'rmse_log1p': 0.7684656889012438, 'c1_bit_acc': 0.8342809375, 'c2_bit_acc': 0.8132375, 'c1_decoded_acc': 0.67049, 'c2_decoded_acc': 0.6193}
[65] train: {'loss': 1.1991296650399101, 'rmse_km': 77.18837613369159, 'rmse_log1p': 0.7623550496140614, 'c1_loss': 0.2837130858813392, 'c2_loss': 0.3342313783486684}  |  val: {'rmse_km': 76.55744243499453, 'rmse_log1p': 0.7665858176005523, 'c1_bit_acc': 0.8323134375, 'c2_bit_acc': 0.814158125, 'c1_decoded_acc': 0.66861, 'c2_decoded_acc': 0.62013}
[66] train: {'loss': 1.195775035311381, 'rmse_km': 75.53291462274079, 'rmse_log1p': 0.7609231559764412, 'c1_loss': 0.2832144446998172, 'c2_loss': 0.3335565892071194}  |  val: {'rmse_km': 73.18029092910707, 'rmse_log1p': 0.7630351502482529, 'c1_bit_acc': 0.8329328125, 'c2_bit_acc': 0.81587875, 'c1_decoded_acc': 0.66798, 'c2_decoded_acc': 0.62502}
[67] train: {'loss': 1.1875442659123738, 'rmse_km': 74.56799081312471, 'rmse_log1p': 0.7567077528166075, 'c1_loss': 0.2824250808376736, 'c2_loss': 0.3325125843715668}  |  val: {'rmse_km': 86.2586612499, 'rmse_log1p': 0.7701651968178024, 'c1_bit_acc': 0.8345503125, 'c2_bit_acc': 0.81439, 'c1_decoded_acc': 0.6722, 'c2_decoded_acc': 0.62407}
[68] train: {'loss': 1.1913151632648045, 'rmse_km': 75.57713167374936, 'rmse_log1p': 0.7589222362798854, 'c1_loss': 0.28281700573285423, 'c2_loss': 0.33253525499873693}  |  val: {'rmse_km': 89.63853737546424, 'rmse_log1p': 0.7615459539582851, 'c1_bit_acc': 0.832495625, 'c2_bit_acc': 0.8163415625, 'c1_decoded_acc': 0.66847, 'c2_decoded_acc': 0.62532}
[69] train: {'loss': 1.1812519367896186, 'rmse_km': 75.67596100624525, 'rmse_log1p': 0.7540563720504717, 'c1_loss': 0.28156999341540867, 'c2_loss': 0.33108089498943755}  |  val: {'rmse_km': 77.40094160744268, 'rmse_log1p': 0.7648496009984721, 'c1_bit_acc': 0.83481375, 'c2_bit_acc': 0.81472625, 'c1_decoded_acc': 0.67299, 'c2_decoded_acc': 0.62252}
[70] train: {'loss': 1.1785855347569782, 'rmse_km': 74.8120235469373, 'rmse_log1p': 0.7527869023602515, 'c1_loss': 0.2813076243231032, 'c2_loss': 0.33058967602941725}  |  val: {'rmse_km': 77.2577267828678, 'rmse_log1p': 0.7646765380996559, 'c1_bit_acc': 0.8329378125, 'c2_bit_acc': 0.81656875, 'c1_decoded_acc': 0.66965, 'c2_decoded_acc': 0.62613}
[71] train: {'loss': 1.1834009727223713, 'rmse_km': 75.98413562835007, 'rmse_log1p': 0.7555825369667217, 'c1_loss': 0.28169755216598513, 'c2_loss': 0.33079845868852403}  |  val: {'rmse_km': 78.38331669390816, 'rmse_log1p': 0.7627211797139988, 'c1_bit_acc': 0.8350803125, 'c2_bit_acc': 0.8174125, 'c1_decoded_acc': 0.67338, 'c2_decoded_acc': 0.62741}
[72] train: {'loss': 1.1790943794589572, 'rmse_km': 74.80344034534775, 'rmse_log1p': 0.7535740807434292, 'c1_loss': 0.2811251471540663, 'c2_loss': 0.3300952244695028}  |  val: {'rmse_km': 81.05968094558477, 'rmse_log1p': 0.7585966241784063, 'c1_bit_acc': 0.8343546875, 'c2_bit_acc': 0.816381875, 'c1_decoded_acc': 0.67227, 'c2_decoded_acc': 0.62715}
[73] train: {'loss': 1.1729300507609048, 'rmse_km': 75.40654462748077, 'rmse_log1p': 0.7505296188217959, 'c1_loss': 0.2805174553394318, 'c2_loss': 0.32911782401826645}  |  val: {'rmse_km': 73.68266589847472, 'rmse_log1p': 0.759081731295873, 'c1_bit_acc': 0.834483125, 'c2_bit_acc': 0.8165859375, 'c1_decoded_acc': 0.67131, 'c2_decoded_acc': 0.62609}
[74] train: {'loss': 1.173676323606703, 'rmse_km': 76.14087029254559, 'rmse_log1p': 0.751000492027213, 'c1_loss': 0.28065756235228645, 'c2_loss': 0.3290170023123423}  |  val: {'rmse_km': 78.88669312097257, 'rmse_log1p': 0.7551893078391609, 'c1_bit_acc': 0.8362546875, 'c2_bit_acc': 0.8177953125, 'c1_decoded_acc': 0.67426, 'c2_decoded_acc': 0.63}
[75] train: {'loss': 1.174839428460863, 'rmse_km': 75.79208685402125, 'rmse_log1p': 0.7517888273608964, 'c1_loss': 0.2807913390753004, 'c2_loss': 0.3288616818025377}  |  val: {'rmse_km': 73.18979501098497, 'rmse_log1p': 0.7617158547370857, 'c1_bit_acc': 0.83415375, 'c2_bit_acc': 0.8172378125, 'c1_decoded_acc': 0.67151, 'c2_decoded_acc': 0.62736}
[76] train: {'loss': 1.171153688422309, 'rmse_km': 75.24400412159098, 'rmse_log1p': 0.7502941111226131, 'c1_loss': 0.2799943817838033, 'c2_loss': 0.3282182118595971}  |  val: {'rmse_km': 77.20551409225898, 'rmse_log1p': 0.7541741404154283, 'c1_bit_acc': 0.8357140625, 'c2_bit_acc': 0.8170975, 'c1_decoded_acc': 0.67373, 'c2_decoded_acc': 0.62899}
[77] train: {'loss': 1.1681389808485243, 'rmse_km': 75.31443202916026, 'rmse_log1p': 0.748403518956575, 'c1_loss': 0.28005041627989874, 'c2_loss': 0.32798077031771344}  |  val: {'rmse_km': 73.78925729526962, 'rmse_log1p': 0.7584000502222181, 'c1_bit_acc': 0.83649625, 'c2_bit_acc': 0.8167196875, 'c1_decoded_acc': 0.67531, 'c2_decoded_acc': 0.62745}
[78] train: {'loss': 1.1636588958909777, 'rmse_km': 74.61184714490722, 'rmse_log1p': 0.7463318210263907, 'c1_loss': 0.27937962277200484, 'c2_loss': 0.32726808598094514}  |  val: {'rmse_km': 73.430265601113, 'rmse_log1p': 0.7553342034690381, 'c1_bit_acc': 0.8363821875, 'c2_bit_acc': 0.8179421875, 'c1_decoded_acc': 0.67671, 'c2_decoded_acc': 0.62985}
[79] train: {'loss': 1.16291899494595, 'rmse_km': 74.65771830389508, 'rmse_log1p': 0.7464448991255634, 'c1_loss': 0.2791790394507514, 'c2_loss': 0.3265600761180454}  |  val: {'rmse_km': 77.94471385519836, 'rmse_log1p': 0.7573010793430641, 'c1_bit_acc': 0.8345109375, 'c2_bit_acc': 0.81900625, 'c1_decoded_acc': 0.67269, 'c2_decoded_acc': 0.63301}
[80] train: {'loss': 1.1615581884214614, 'rmse_km': 75.31210775312792, 'rmse_log1p': 0.7456452784374776, 'c1_loss': 0.279192692428165, 'c2_loss': 0.3263786836274465}  |  val: {'rmse_km': 74.89125906001146, 'rmse_log1p': 0.7516610903719876, 'c1_bit_acc': 0.837066875, 'c2_bit_acc': 0.8185815625, 'c1_decoded_acc': 0.67636, 'c2_decoded_acc': 0.63118}
[81] train: {'loss': 1.1638010802883572, 'rmse_km': 75.38821401585264, 'rmse_log1p': 0.7472439034431195, 'c1_loss': 0.2791018696170383, 'c2_loss': 0.32632578429751924}  |  val: {'rmse_km': 77.40465405096776, 'rmse_log1p': 0.7537249015943932, 'c1_bit_acc': 0.8361321875, 'c2_bit_acc': 0.81716, 'c1_decoded_acc': 0.67596, 'c2_decoded_acc': 0.63007}
[82] train: {'loss': 1.1563903437889946, 'rmse_km': 75.86529810810242, 'rmse_log1p': 0.7432364429811845, 'c1_loss': 0.27857438545862834, 'c2_loss': 0.32541554947747126}  |  val: {'rmse_km': 76.83902867765183, 'rmse_log1p': 0.7597574267888946, 'c1_bit_acc': 0.83589875, 'c2_bit_acc': 0.819429375, 'c1_decoded_acc': 0.67428, 'c2_decoded_acc': 0.63373}
[83] train: {'loss': 1.1559333982594808, 'rmse_km': 74.8564642123511, 'rmse_log1p': 0.7432193610211248, 'c1_loss': 0.2783160871802436, 'c2_loss': 0.32524227640893727}  |  val: {'rmse_km': 76.51344410563577, 'rmse_log1p': 0.750841979429682, 'c1_bit_acc': 0.8370628125, 'c2_bit_acc': 0.8188171875, 'c1_decoded_acc': 0.6764, 'c2_decoded_acc': 0.63292}
[84] train: {'loss': 1.1501722667694092, 'rmse_km': 75.29843294455901, 'rmse_log1p': 0.7402609868160264, 'c1_loss': 0.2778098653507233, 'c2_loss': 0.32437611309475367}  |  val: {'rmse_km': 78.24374725417361, 'rmse_log1p': 0.7511771421599941, 'c1_bit_acc': 0.8359146875, 'c2_bit_acc': 0.818875, 'c1_decoded_acc': 0.67555, 'c2_decoded_acc': 0.63295}
[85] train: {'loss': 1.1476600236299304, 'rmse_km': 75.42638238810244, 'rmse_log1p': 0.7391611739050953, 'c1_loss': 0.2773352739630805, 'c2_loss': 0.3239654882335663}  |  val: {'rmse_km': 78.27577014253038, 'rmse_log1p': 0.7461820620054203, 'c1_bit_acc': 0.8382053125, 'c2_bit_acc': 0.818495625, 'c1_decoded_acc': 0.67993, 'c2_decoded_acc': 0.63242}
[86] train: {'loss': 1.1488785517840916, 'rmse_km': 75.36948375855609, 'rmse_log1p': 0.7398999749705536, 'c1_loss': 0.2775255139128367, 'c2_loss': 0.3239009493287404}  |  val: {'rmse_km': 77.30671461781311, 'rmse_log1p': 0.7513265798576042, 'c1_bit_acc': 0.8368615625, 'c2_bit_acc': 0.8192275, 'c1_decoded_acc': 0.67632, 'c2_decoded_acc': 0.63327}
[87] train: {'loss': 1.1479454011874728, 'rmse_km': 75.22984637201016, 'rmse_log1p': 0.7395034039427416, 'c1_loss': 0.2774043674723307, 'c2_loss': 0.3236757131703695}  |  val: {'rmse_km': 79.26836156078446, 'rmse_log1p': 0.7497493404501278, 'c1_bit_acc': 0.8383246875, 'c2_bit_acc': 0.8195153125, 'c1_decoded_acc': 0.67868, 'c2_decoded_acc': 0.63526}
[88] train: {'loss': 1.1531242834981283, 'rmse_km': 75.99990362863956, 'rmse_log1p': 0.742787770913648, 'c1_loss': 0.2776255503898197, 'c2_loss': 0.3237650918536716}  |  val: {'rmse_km': 76.45046650037526, 'rmse_log1p': 0.7563992329417575, 'c1_bit_acc': 0.836925, 'c2_bit_acc': 0.820005625, 'c1_decoded_acc': 0.67697, 'c2_decoded_acc': 0.63558}
[89] train: {'loss': 1.14290487001631, 'rmse_km': 74.44500381993409, 'rmse_log1p': 0.7373676601574229, 'c1_loss': 0.2766574946223365, 'c2_loss': 0.3225362956110636}  |  val: {'rmse_km': 74.29759299074735, 'rmse_log1p': 0.7497136841081654, 'c1_bit_acc': 0.836910625, 'c2_bit_acc': 0.8201559375, 'c1_decoded_acc': 0.67767, 'c2_decoded_acc': 0.63434}
[90] train: {'loss': 1.1450540541119045, 'rmse_km': 76.33880266921109, 'rmse_log1p': 0.7387219682851963, 'c1_loss': 0.2768125559287601, 'c2_loss': 0.32253129601690506}  |  val: {'rmse_km': 80.09903842763188, 'rmse_log1p': 0.7505664275961835, 'c1_bit_acc': 0.836693125, 'c2_bit_acc': 0.81986, 'c1_decoded_acc': 0.67715, 'c2_decoded_acc': 0.63717}
[91] train: {'loss': 1.1413407055324978, 'rmse_km': 75.17626097940592, 'rmse_log1p': 0.7369169112331674, 'c1_loss': 0.2763984430567423, 'c2_loss': 0.32189581170717874}  |  val: {'rmse_km': 75.7647952496326, 'rmse_log1p': 0.7428599072302745, 'c1_bit_acc': 0.837073125, 'c2_bit_acc': 0.821226875, 'c1_decoded_acc': 0.67869, 'c2_decoded_acc': 0.637}
[92] train: {'loss': 1.1385699876997206, 'rmse_km': 75.35740362598754, 'rmse_log1p': 0.7355284053936947, 'c1_loss': 0.275967427716785, 'c2_loss': 0.32160050621562536}  |  val: {'rmse_km': 76.70475623392757, 'rmse_log1p': 0.7517448632306147, 'c1_bit_acc': 0.83683125, 'c2_bit_acc': 0.820334375, 'c1_decoded_acc': 0.68024, 'c2_decoded_acc': 0.63605}
[93] train: {'loss': 1.1398154822031656, 'rmse_km': 75.83997402528729, 'rmse_log1p': 0.7362840877083383, 'c1_loss': 0.2760240664821201, 'c2_loss': 0.32167722880363464}  |  val: {'rmse_km': 76.74387954016268, 'rmse_log1p': 0.743633307590912, 'c1_bit_acc': 0.838206875, 'c2_bit_acc': 0.8209928125, 'c1_decoded_acc': 0.68051, 'c2_decoded_acc': 0.63746}
[94] train: {'loss': 1.1363992893007067, 'rmse_km': 74.41147674313251, 'rmse_log1p': 0.7348387045568454, 'c1_loss': 0.2756498976686266, 'c2_loss': 0.32076144843207466}  |  val: {'rmse_km': 75.76543327208161, 'rmse_log1p': 0.751737965108471, 'c1_bit_acc': 0.8379615625, 'c2_bit_acc': 0.8209634375, 'c1_decoded_acc': 0.67965, 'c2_decoded_acc': 0.6362}
[95] train: {'loss': 1.1357371947606405, 'rmse_km': 75.60860811504038, 'rmse_log1p': 0.7342977280240949, 'c1_loss': 0.2757052417320675, 'c2_loss': 0.32083890583886043}  |  val: {'rmse_km': 74.84541360364041, 'rmse_log1p': 0.744047344298539, 'c1_bit_acc': 0.8384825, 'c2_bit_acc': 0.8207896875, 'c1_decoded_acc': 0.67899, 'c2_decoded_acc': 0.63626}
[96] train: {'loss': 1.1326650135379368, 'rmse_km': 75.13979159706261, 'rmse_log1p': 0.7331644591682479, 'c1_loss': 0.2750882115607792, 'c2_loss': 0.3200465425660875}  |  val: {'rmse_km': 76.21702988526415, 'rmse_log1p': 0.7371027587852453, 'c1_bit_acc': 0.8376246875, 'c2_bit_acc': 0.8219996875, 'c1_decoded_acc': 0.67814, 'c2_decoded_acc': 0.63774}
[97] train: {'loss': 1.1282829410680135, 'rmse_km': 75.324681328151, 'rmse_log1p': 0.7304150158706989, 'c1_loss': 0.2748992109966278, 'c2_loss': 0.31987750253041586}  |  val: {'rmse_km': 76.1993876595311, 'rmse_log1p': 0.7446535600426906, 'c1_bit_acc': 0.83792125, 'c2_bit_acc': 0.8212540625, 'c1_decoded_acc': 0.67918, 'c2_decoded_acc': 0.63651}
[98] train: {'loss': 1.1273208575227525, 'rmse_km': 75.19169837093887, 'rmse_log1p': 0.7299084477953971, 'c1_loss': 0.27493062161657544, 'c2_loss': 0.3196238483344184}  |  val: {'rmse_km': 76.401086226326, 'rmse_log1p': 0.7359075584719108, 'c1_bit_acc': 0.839208125, 'c2_bit_acc': 0.8219915625, 'c1_decoded_acc': 0.68158, 'c2_decoded_acc': 0.63813}
[99] train: {'loss': 1.1260845986853705, 'rmse_km': 75.85805064497934, 'rmse_log1p': 0.7295192728797651, 'c1_loss': 0.27450402429156834, 'c2_loss': 0.3193822158601549}  |  val: {'rmse_km': 75.15505131580478, 'rmse_log1p': 0.7374938722129604, 'c1_bit_acc': 0.83755125, 'c2_bit_acc': 0.8225925, 'c1_decoded_acc': 0.68019, 'c2_decoded_acc': 0.63892}
[100] train: {'loss': 1.1265108066389296, 'rmse_km': 75.71034376057045, 'rmse_log1p': 0.7299858577873821, 'c1_loss': 0.27448177788416545, 'c2_loss': 0.319149775007036}  |  val: {'rmse_km': 76.0947028944443, 'rmse_log1p': 0.7423507912345426, 'c1_bit_acc': 0.838936875, 'c2_bit_acc': 0.82166125, 'c1_decoded_acc': 0.68159, 'c2_decoded_acc': 0.63944}
[101] train: {'loss': 1.132360673552619, 'rmse_km': 76.4893017437733, 'rmse_log1p': 0.733465849397996, 'c1_loss': 0.2748793949116601, 'c2_loss': 0.3195091919846005}  |  val: {'rmse_km': 75.70038533484325, 'rmse_log1p': 0.7442413422116516, 'c1_bit_acc': 0.83738125, 'c2_bit_acc': 0.821621875, 'c1_decoded_acc': 0.67872, 'c2_decoded_acc': 0.63605}
[102] train: {'loss': 1.1273627313656278, 'rmse_km': 75.22909346726338, 'rmse_log1p': 0.7309509970212686, 'c1_loss': 0.27429575770272147, 'c2_loss': 0.31877766419834563}  |  val: {'rmse_km': 76.23988150076048, 'rmse_log1p': 0.7409624127882041, 'c1_bit_acc': 0.8381496875, 'c2_bit_acc': 0.822401875, 'c1_decoded_acc': 0.68154, 'c2_decoded_acc': 0.64066}
[103] train: {'loss': 1.1246933698484634, 'rmse_km': 75.95438983980782, 'rmse_log1p': 0.7293916400622802, 'c1_loss': 0.2742311898242103, 'c2_loss': 0.31845012986395094}  |  val: {'rmse_km': 73.1566938527757, 'rmse_log1p': 0.7429884353420533, 'c1_bit_acc': 0.838489375, 'c2_bit_acc': 0.8216165625, 'c1_decoded_acc': 0.68205, 'c2_decoded_acc': 0.63871}
[104] train: {'loss': 1.1244189219156902, 'rmse_km': 75.04749472729753, 'rmse_log1p': 0.7295103670890909, 'c1_loss': 0.2739192825624678, 'c2_loss': 0.31831429092407226}  |  val: {'rmse_km': 75.39237854178299, 'rmse_log1p': 0.7364739797207951, 'c1_bit_acc': 0.8399390625, 'c2_bit_acc': 0.821663125, 'c1_decoded_acc': 0.68412, 'c2_decoded_acc': 0.63952}
[105] train: {'loss': 1.1175300762006972, 'rmse_km': 75.0609973309208, 'rmse_log1p': 0.7258286410361446, 'c1_loss': 0.27333484197510616, 'c2_loss': 0.31736804747687447}  |  val: {'rmse_km': 77.07743924537841, 'rmse_log1p': 0.7372738054894289, 'c1_bit_acc': 0.8402675, 'c2_bit_acc': 0.8227221875, 'c1_decoded_acc': 0.68442, 'c2_decoded_acc': 0.64013}
[106] train: {'loss': 1.117510373433431, 'rmse_km': 75.15037983831985, 'rmse_log1p': 0.7257810101955252, 'c1_loss': 0.2733976939445072, 'c2_loss': 0.31735452817281085}  |  val: {'rmse_km': 78.28672947389455, 'rmse_log1p': 0.7405884633126077, 'c1_bit_acc': 0.8390115625, 'c2_bit_acc': 0.8223415625, 'c1_decoded_acc': 0.68329, 'c2_decoded_acc': 0.6395}
[107] train: {'loss': 1.1206439214070638, 'rmse_km': 75.68383881008712, 'rmse_log1p': 0.7276893409313206, 'c1_loss': 0.27361874146991305, 'c2_loss': 0.317493379773034}  |  val: {'rmse_km': 74.79395198748526, 'rmse_log1p': 0.7389651163795626, 'c1_bit_acc': 0.839443125, 'c2_bit_acc': 0.822109375, 'c1_decoded_acc': 0.68318, 'c2_decoded_acc': 0.64015}
[108] train: {'loss': 1.1139389928860135, 'rmse_km': 74.663784153112, 'rmse_log1p': 0.7240933125491996, 'c1_loss': 0.27288962390899657, 'c2_loss': 0.3167380510626899}  |  val: {'rmse_km': 79.61681301121328, 'rmse_log1p': 0.7387218472559345, 'c1_bit_acc': 0.8391640625, 'c2_bit_acc': 0.8229775, 'c1_decoded_acc': 0.68383, 'c2_decoded_acc': 0.64016}
[109] train: {'loss': 1.1181099749077692, 'rmse_km': 75.2030779269539, 'rmse_log1p': 0.7266392821072017, 'c1_loss': 0.27318236708958943, 'c2_loss': 0.3169229931894938}  |  val: {'rmse_km': 75.75127306582874, 'rmse_log1p': 0.7381895704717574, 'c1_bit_acc': 0.84009, 'c2_bit_acc': 0.8219184375, 'c1_decoded_acc': 0.68577, 'c2_decoded_acc': 0.63885}
[110] train: {'loss': 1.1146128763241239, 'rmse_km': 75.14687441520772, 'rmse_log1p': 0.7248921626559436, 'c1_loss': 0.27276973013771905, 'c2_loss': 0.3163744084993998}  |  val: {'rmse_km': 75.87779288517162, 'rmse_log1p': 0.7308260609849617, 'c1_bit_acc': 0.83907, 'c2_bit_acc': 0.8240103125, 'c1_decoded_acc': 0.68381, 'c2_decoded_acc': 0.64233}
[111] train: {'loss': 1.1095549110454983, 'rmse_km': 75.30130233145042, 'rmse_log1p': 0.7220000716021812, 'c1_loss': 0.27241080437024434, 'c2_loss': 0.3158598098426395}  |  val: {'rmse_km': 74.52491128705724, 'rmse_log1p': 0.7317819470051489, 'c1_bit_acc': 0.8406840625, 'c2_bit_acc': 0.8233021875, 'c1_decoded_acc': 0.68569, 'c2_decoded_acc': 0.64149}
[112] train: {'loss': 1.110661032125685, 'rmse_km': 75.78079252439235, 'rmse_log1p': 0.7228353330021451, 'c1_loss': 0.27242129073143007, 'c2_loss': 0.3157488780434926}  |  val: {'rmse_km': 78.7068116939776, 'rmse_log1p': 0.7371137156962647, 'c1_bit_acc': 0.84008625, 'c2_bit_acc': 0.823215, 'c1_decoded_acc': 0.6849, 'c2_decoded_acc': 0.64052}
[113] train: {'loss': 1.1086213518439398, 'rmse_km': 75.02548069760199, 'rmse_log1p': 0.7216688266293076, 'c1_loss': 0.27227819326294794, 'c2_loss': 0.31553735436863367}  |  val: {'rmse_km': 76.66898525989014, 'rmse_log1p': 0.7428934053069522, 'c1_bit_acc': 0.8399971875, 'c2_bit_acc': 0.82339125, 'c1_decoded_acc': 0.68523, 'c2_decoded_acc': 0.64205}
[114] train: {'loss': 1.110195089539422, 'rmse_km': 74.13883526554251, 'rmse_log1p': 0.7228830342526563, 'c1_loss': 0.27228651449521385, 'c2_loss': 0.3153486366144816}  |  val: {'rmse_km': 75.62243991017976, 'rmse_log1p': 0.7324909228520852, 'c1_bit_acc': 0.8400003125, 'c2_bit_acc': 0.824253125, 'c1_decoded_acc': 0.68507, 'c2_decoded_acc': 0.64389}
[115] train: {'loss': 1.1108651009792752, 'rmse_km': 75.3108467142184, 'rmse_log1p': 0.7235230067825688, 'c1_loss': 0.2720574842400021, 'c2_loss': 0.3153220185682509}  |  val: {'rmse_km': 74.22055260968824, 'rmse_log1p': 0.7362413431121735, 'c1_bit_acc': 0.83986625, 'c2_bit_acc': 0.824475625, 'c1_decoded_acc': 0.68603, 'c2_decoded_acc': 0.64194}
[116] train: {'loss': 1.1127212338383992, 'rmse_km': 75.13302005859342, 'rmse_log1p': 0.7246030411353482, 'c1_loss': 0.2723176467715369, 'c2_loss': 0.3153538997936249}  |  val: {'rmse_km': 81.43810257355736, 'rmse_log1p': 0.72959651992474, 'c1_bit_acc': 0.8392903125, 'c2_bit_acc': 0.82491875, 'c1_decoded_acc': 0.68264, 'c2_decoded_acc': 0.64595}
[117] train: {'loss': 1.1062303022638957, 'rmse_km': 75.86727076570963, 'rmse_log1p': 0.7207891728172277, 'c1_loss': 0.2718303761121962, 'c2_loss': 0.3148628823990292}  |  val: {'rmse_km': 79.89586423022001, 'rmse_log1p': 0.7335230572878861, 'c1_bit_acc': 0.84047125, 'c2_bit_acc': 0.8253190625, 'c1_decoded_acc': 0.68584, 'c2_decoded_acc': 0.64486}
[118] train: {'loss': 1.102169836247762, 'rmse_km': 75.11785336743357, 'rmse_log1p': 0.7188079230147308, 'c1_loss': 0.2713649493980408, 'c2_loss': 0.3141201307911343}  |  val: {'rmse_km': 79.91663747501205, 'rmse_log1p': 0.732908448402199, 'c1_bit_acc': 0.83929875, 'c2_bit_acc': 0.82534625, 'c1_decoded_acc': 0.68365, 'c2_decoded_acc': 0.64565}
[119] train: {'loss': 1.0983541059705946, 'rmse_km': 74.51705839730592, 'rmse_log1p': 0.7167775413961748, 'c1_loss': 0.2709397435336643, 'c2_loss': 0.3136444046105279}  |  val: {'rmse_km': 75.02213865961501, 'rmse_log1p': 0.7339497004302735, 'c1_bit_acc': 0.841305625, 'c2_bit_acc': 0.823775, 'c1_decoded_acc': 0.68762, 'c2_decoded_acc': 0.64313}
[120] train: {'loss': 1.0992602992418077, 'rmse_km': 74.81732636374244, 'rmse_log1p': 0.7173478090723552, 'c1_loss': 0.270951903391944, 'c2_loss': 0.31372049813694425}  |  val: {'rmse_km': 74.86870017320322, 'rmse_log1p': 0.7357146442018289, 'c1_bit_acc': 0.8406809375, 'c2_bit_acc': 0.82455875, 'c1_decoded_acc': 0.68576, 'c2_decoded_acc': 0.64371}
[121] train: {'loss': 1.1046182075246176, 'rmse_km': 74.94415238404194, 'rmse_log1p': 0.7204531104153125, 'c1_loss': 0.27143254398557876, 'c2_loss': 0.3141329791641235}  |  val: {'rmse_km': 75.4673686467784, 'rmse_log1p': 0.7309892401418683, 'c1_bit_acc': 0.8403153125, 'c2_bit_acc': 0.8246946875, 'c1_decoded_acc': 0.68509, 'c2_decoded_acc': 0.64473}
[122] train: {'loss': 1.099561961034139, 'rmse_km': 75.24542851043344, 'rmse_log1p': 0.7179900173486813, 'c1_loss': 0.27072940405951607, 'c2_loss': 0.31332298382441204}  |  val: {'rmse_km': 76.20753492212073, 'rmse_log1p': 0.7344815603009923, 'c1_bit_acc': 0.8407078125, 'c2_bit_acc': 0.82512625, 'c1_decoded_acc': 0.68655, 'c2_decoded_acc': 0.64291}
[123] train: {'loss': 1.0990435480456882, 'rmse_km': 74.51064311559792, 'rmse_log1p': 0.717503337254223, 'c1_loss': 0.2708765032397376, 'c2_loss': 0.3133560345469581}  |  val: {'rmse_km': 76.77033334583906, 'rmse_log1p': 0.7251431537572491, 'c1_bit_acc': 0.8402621875, 'c2_bit_acc': 0.825881875, 'c1_decoded_acc': 0.68545, 'c2_decoded_acc': 0.6465}
[124] train: {'loss': 1.0995980818388198, 'rmse_km': 74.40027472332511, 'rmse_log1p': 0.7180548914060425, 'c1_loss': 0.27071979271146984, 'c2_loss': 0.3132754076396094}  |  val: {'rmse_km': 73.15118721802298, 'rmse_log1p': 0.7284927569116327, 'c1_bit_acc': 0.840004375, 'c2_bit_acc': 0.8267134375, 'c1_decoded_acc': 0.68622, 'c2_decoded_acc': 0.64841}
[125] train: {'loss': 1.0929352673806085, 'rmse_km': 75.15972575122929, 'rmse_log1p': 0.7143308957319846, 'c1_loss': 0.27009125243822735, 'c2_loss': 0.3125755157078637}  |  val: {'rmse_km': 78.68257902603028, 'rmse_log1p': 0.7295255640608604, 'c1_bit_acc': 0.8417834375, 'c2_bit_acc': 0.8253146875, 'c1_decoded_acc': 0.68969, 'c2_decoded_acc': 0.64567}
[126] train: {'loss': 1.0951590486738416, 'rmse_km': 75.43176824227476, 'rmse_log1p': 0.7157411622632023, 'c1_loss': 0.27029744013468426, 'c2_loss': 0.31257617387983533}  |  val: {'rmse_km': 74.52305379461446, 'rmse_log1p': 0.726470777403009, 'c1_bit_acc': 0.84209625, 'c2_bit_acc': 0.8250296875, 'c1_decoded_acc': 0.69058, 'c2_decoded_acc': 0.64688}
[127] train: {'loss': 1.099155032556322, 'rmse_km': 75.16965836733928, 'rmse_log1p': 0.7181581465306544, 'c1_loss': 0.2706104989051819, 'c2_loss': 0.3127933869700962}  |  val: {'rmse_km': 75.42338180854462, 'rmse_log1p': 0.7243327720781526, 'c1_bit_acc': 0.84121375, 'c2_bit_acc': 0.8256446875, 'c1_decoded_acc': 0.68746, 'c2_decoded_acc': 0.64658}
[128] train: {'loss': 1.0870223085106743, 'rmse_km': 74.9307818610783, 'rmse_log1p': 0.7116373830066673, 'c1_loss': 0.26928082028812833, 'c2_loss': 0.31131374710294935}  |  val: {'rmse_km': 74.71901466389764, 'rmse_log1p': 0.723635613028066, 'c1_bit_acc': 0.8405, 'c2_bit_acc': 0.827144375, 'c1_decoded_acc': 0.68634, 'c2_decoded_acc': 0.6485}
[129] train: {'loss': 1.0925552307679918, 'rmse_km': 74.30233779864366, 'rmse_log1p': 0.7146336814856155, 'c1_loss': 0.2698859004380968, 'c2_loss': 0.31196795692125956}  |  val: {'rmse_km': 77.1194949666182, 'rmse_log1p': 0.7294486363495408, 'c1_bit_acc': 0.841126875, 'c2_bit_acc': 0.8251359375, 'c1_decoded_acc': 0.68763, 'c2_decoded_acc': 0.64468}
[130] train: {'loss': 1.0921475945070054, 'rmse_km': 75.25625168694458, 'rmse_log1p': 0.7145541495618771, 'c1_loss': 0.269790367825826, 'c2_loss': 0.3117695193534427}  |  val: {'rmse_km': 77.43006547241517, 'rmse_log1p': 0.7252569466764125, 'c1_bit_acc': 0.840656875, 'c2_bit_acc': 0.8276975, 'c1_decoded_acc': 0.68615, 'c2_decoded_acc': 0.65042}
[131] train: {'loss': 1.0920896694183349, 'rmse_km': 76.34439597557243, 'rmse_log1p': 0.7148733497703303, 'c1_loss': 0.2696949948893653, 'c2_loss': 0.31135074868943957}  |  val: {'rmse_km': 78.32701070172888, 'rmse_log1p': 0.7281836604772712, 'c1_bit_acc': 0.840713125, 'c2_bit_acc': 0.8270246875, 'c1_decoded_acc': 0.68618, 'c2_decoded_acc': 0.6508}
[132] train: {'loss': 1.0888829019843207, 'rmse_km': 75.00108072138028, 'rmse_log1p': 0.712698631038451, 'c1_loss': 0.26953936310026383, 'c2_loss': 0.31140436469078064}  |  val: {'rmse_km': 76.64878110271063, 'rmse_log1p': 0.7251106029857427, 'c1_bit_acc': 0.8419459375, 'c2_bit_acc': 0.826199375, 'c1_decoded_acc': 0.68875, 'c2_decoded_acc': 0.64946}
[133] train: {'loss': 1.0830462076441447, 'rmse_km': 74.06058146249258, 'rmse_log1p': 0.709534360823777, 'c1_loss': 0.2688695639790429, 'c2_loss': 0.3107376959514618}  |  val: {'rmse_km': 75.91763822043433, 'rmse_log1p': 0.7192792188048339, 'c1_bit_acc': 0.8424421875, 'c2_bit_acc': 0.8279625, 'c1_decoded_acc': 0.68958, 'c2_decoded_acc': 0.65195}
[134] train: {'loss': 1.0885496645821466, 'rmse_km': 75.17269180859496, 'rmse_log1p': 0.7127539098626363, 'c1_loss': 0.26945492895656165, 'c2_loss': 0.3110767792563968}  |  val: {'rmse_km': 77.15416157562403, 'rmse_log1p': 0.7271237410399523, 'c1_bit_acc': 0.8413465625, 'c2_bit_acc': 0.8252140625, 'c1_decoded_acc': 0.68783, 'c2_decoded_acc': 0.64626}
[135] train: {'loss': 1.0871778867128161, 'rmse_km': 74.29934111311991, 'rmse_log1p': 0.7124907325677321, 'c1_loss': 0.268979322048823, 'c2_loss': 0.3105556614653269}  |  val: {'rmse_km': 75.30541654966626, 'rmse_log1p': 0.7223807144691523, 'c1_bit_acc': 0.8421175, 'c2_bit_acc': 0.82622875, 'c1_decoded_acc': 0.68888, 'c2_decoded_acc': 0.64764}
[136] train: {'loss': 1.0857657711325752, 'rmse_km': 74.66018394302448, 'rmse_log1p': 0.7114619322462826, 'c1_loss': 0.269032917321523, 'c2_loss': 0.3105547618484497}  |  val: {'rmse_km': 76.82167548432376, 'rmse_log1p': 0.7266106948455006, 'c1_bit_acc': 0.839885625, 'c2_bit_acc': 0.8275890625, 'c1_decoded_acc': 0.68526, 'c2_decoded_acc': 0.65076}
[137] train: {'loss': 1.0895535438410442, 'rmse_km': 74.89756350864326, 'rmse_log1p': 0.7138446433790628, 'c1_loss': 0.2692030504449209, 'c2_loss': 0.3107763569736481}  |  val: {'rmse_km': 74.31623203412563, 'rmse_log1p': 0.7229256205228725, 'c1_bit_acc': 0.84137125, 'c2_bit_acc': 0.8265578125, 'c1_decoded_acc': 0.6886, 'c2_decoded_acc': 0.64833}
[138] train: {'loss': 1.079050185254415, 'rmse_km': 73.47032178773787, 'rmse_log1p': 0.7080402656220598, 'c1_loss': 0.2681589347330729, 'c2_loss': 0.30957024470965067}  |  val: {'rmse_km': 74.8980263789958, 'rmse_log1p': 0.7211669008589487, 'c1_bit_acc': 0.841123125, 'c2_bit_acc': 0.8278584375, 'c1_decoded_acc': 0.68705, 'c2_decoded_acc': 0.65049}
[139] train: {'loss': 1.087795948185391, 'rmse_km': 75.42045879911332, 'rmse_log1p': 0.7132283286176144, 'c1_loss': 0.26873297627131143, 'c2_loss': 0.3103682426802317}  |  val: {'rmse_km': 76.88760694391847, 'rmse_log1p': 0.7215185333906428, 'c1_bit_acc': 0.8417159375, 'c2_bit_acc': 0.8274659375, 'c1_decoded_acc': 0.68814, 'c2_decoded_acc': 0.65113}
[140] train: {'loss': 1.0845111079067653, 'rmse_km': 75.65345216326054, 'rmse_log1p': 0.7114789808040977, 'c1_loss': 0.26846404336399504, 'c2_loss': 0.3098445899581909}  |  val: {'rmse_km': 79.13512598121329, 'rmse_log1p': 0.7167064391418422, 'c1_bit_acc': 0.84290125, 'c2_bit_acc': 0.8278540625, 'c1_decoded_acc': 0.69142, 'c2_decoded_acc': 0.6528}
[141] train: {'loss': 1.0818332612058852, 'rmse_km': 74.72071045106905, 'rmse_log1p': 0.7099686193247366, 'c1_loss': 0.26821448567390443, 'c2_loss': 0.30956329458024767}  |  val: {'rmse_km': 74.20846639282475, 'rmse_log1p': 0.717398990871378, 'c1_bit_acc': 0.843130625, 'c2_bit_acc': 0.82789125, 'c1_decoded_acc': 0.69228, 'c2_decoded_acc': 0.6506}
[142] train: {'loss': 1.0771989019351536, 'rmse_km': 74.41829097238124, 'rmse_log1p': 0.7072888321367938, 'c1_loss': 0.2678106623480055, 'c2_loss': 0.3091307952139113}  |  val: {'rmse_km': 76.63701093670407, 'rmse_log1p': 0.7245414270176148, 'c1_bit_acc': 0.842628125, 'c2_bit_acc': 0.8267071875, 'c1_decoded_acc': 0.69141, 'c2_decoded_acc': 0.64784}
[143] train: {'loss': 1.0803452147928874, 'rmse_km': 74.69412888992682, 'rmse_log1p': 0.7091021059087024, 'c1_loss': 0.26819372083557974, 'c2_loss': 0.3093257178370158}  |  val: {'rmse_km': 75.26343707895289, 'rmse_log1p': 0.7200190908497144, 'c1_bit_acc': 0.8423325, 'c2_bit_acc': 0.82650125, 'c1_decoded_acc': 0.69003, 'c2_decoded_acc': 0.64861}
[144] train: {'loss': 1.0759812050671047, 'rmse_km': 74.22524642620763, 'rmse_log1p': 0.7068615282901572, 'c1_loss': 0.26762682043393454, 'c2_loss': 0.3087010118611654}  |  val: {'rmse_km': 77.86078760257791, 'rmse_log1p': 0.71854161268503, 'c1_bit_acc': 0.8421421875, 'c2_bit_acc': 0.826804375, 'c1_decoded_acc': 0.69092, 'c2_decoded_acc': 0.65055}
[145] train: {'loss': 1.0757230734888712, 'rmse_km': 75.3923267294988, 'rmse_log1p': 0.7067859919774738, 'c1_loss': 0.26753915049976773, 'c2_loss': 0.3086375439982944}  |  val: {'rmse_km': 77.03175709772236, 'rmse_log1p': 0.7165500725301922, 'c1_bit_acc': 0.843466875, 'c2_bit_acc': 0.828229375, 'c1_decoded_acc': 0.69238, 'c2_decoded_acc': 0.65196}
[146] train: {'loss': 1.0785358575778536, 'rmse_km': 75.8247426738957, 'rmse_log1p': 0.708214796657088, 'c1_loss': 0.2680560139094459, 'c2_loss': 0.3089116830274794}  |  val: {'rmse_km': 75.81676358579941, 'rmse_log1p': 0.7165601791696941, 'c1_bit_acc': 0.8417728125, 'c2_bit_acc': 0.8278896875, 'c1_decoded_acc': 0.68929, 'c2_decoded_acc': 0.65045}
[147] train: {'loss': 1.0720729132334392, 'rmse_km': 74.89379198655253, 'rmse_log1p': 0.7049188618942781, 'c1_loss': 0.2671346620485518, 'c2_loss': 0.30802766012509664}  |  val: {'rmse_km': 76.14545535416903, 'rmse_log1p': 0.7271013210297746, 'c1_bit_acc': 0.841923125, 'c2_bit_acc': 0.8287153125, 'c1_decoded_acc': 0.68908, 'c2_decoded_acc': 0.65338}
[148] train: {'loss': 1.0766588558663261, 'rmse_km': 74.4185501435546, 'rmse_log1p': 0.7075524700913948, 'c1_loss': 0.26760062807506985, 'c2_loss': 0.30842770784166124}  |  val: {'rmse_km': 73.03250694254237, 'rmse_log1p': 0.7181976517993991, 'c1_bit_acc': 0.84366875, 'c2_bit_acc': 0.8270803125, 'c1_decoded_acc': 0.69231, 'c2_decoded_acc': 0.65191}
[149] train: {'loss': 1.0801424491967095, 'rmse_km': 75.32829839484296, 'rmse_log1p': 0.7098304597154993, 'c1_loss': 0.26774479259702894, 'c2_loss': 0.308538371231291}  |  val: {'rmse_km': 78.50390304289813, 'rmse_log1p': 0.7261128008095655, 'c1_bit_acc': 0.8425203125, 'c2_bit_acc': 0.8267209375, 'c1_decoded_acc': 0.6924, 'c2_decoded_acc': 0.64845}
[150] train: {'loss': 1.0730795155800714, 'rmse_km': 74.91320498583677, 'rmse_log1p': 0.705851566543835, 'c1_loss': 0.26722114673084685, 'c2_loss': 0.30763192387898763}  |  val: {'rmse_km': 76.2206398392194, 'rmse_log1p': 0.7217903929831295, 'c1_bit_acc': 0.8428165625, 'c2_bit_acc': 0.828166875, 'c1_decoded_acc': 0.69069, 'c2_decoded_acc': 0.65315}
[151] train: {'loss': 1.0721032733578153, 'rmse_km': 74.30183507365413, 'rmse_log1p': 0.7055292984335271, 'c1_loss': 0.2669171772670746, 'c2_loss': 0.3074145231628418}  |  val: {'rmse_km': 79.77309434910526, 'rmse_log1p': 0.7159904496365819, 'c1_bit_acc': 0.8439246875, 'c2_bit_acc': 0.8272578125, 'c1_decoded_acc': 0.69312, 'c2_decoded_acc': 0.65052}
[152] train: {'loss': 1.0714330080371433, 'rmse_km': 74.34232803915445, 'rmse_log1p': 0.7050739193101391, 'c1_loss': 0.2669403745428721, 'c2_loss': 0.30736332344796924}  |  val: {'rmse_km': 78.04533125350132, 'rmse_log1p': 0.7183407157229474, 'c1_bit_acc': 0.8434871875, 'c2_bit_acc': 0.828608125, 'c1_decoded_acc': 0.69339, 'c2_decoded_acc': 0.65173}
[153] train: {'loss': 1.0716202136823867, 'rmse_km': 74.7505813627058, 'rmse_log1p': 0.7049904554816693, 'c1_loss': 0.26699662003623115, 'c2_loss': 0.30761208510928684}  |  val: {'rmse_km': 75.66938586397573, 'rmse_log1p': 0.724975575660491, 'c1_bit_acc': 0.8428615625, 'c2_bit_acc': 0.8274809375, 'c1_decoded_acc': 0.69191, 'c2_decoded_acc': 0.64901}
[154] train: {'loss': 1.070892036649916, 'rmse_km': 74.5024708587742, 'rmse_log1p': 0.7047537905688207, 'c1_loss': 0.26689115711953904, 'c2_loss': 0.3073230321025848}  |  val: {'rmse_km': 76.66233924041518, 'rmse_log1p': 0.7151419846068544, 'c1_bit_acc': 0.8423334375, 'c2_bit_acc': 0.8304965625, 'c1_decoded_acc': 0.69139, 'c2_decoded_acc': 0.65758}
[155] train: {'loss': 1.069766257854038, 'rmse_km': 73.72109801792666, 'rmse_log1p': 0.704175693879209, 'c1_loss': 0.2668024236721463, 'c2_loss': 0.30710039821306867}  |  val: {'rmse_km': 76.90185633528296, 'rmse_log1p': 0.7247885921976296, 'c1_bit_acc': 0.843669375, 'c2_bit_acc': 0.827711875, 'c1_decoded_acc': 0.69231, 'c2_decoded_acc': 0.65265}
[156] train: {'loss': 1.0662698957655166, 'rmse_km': 74.76843483487032, 'rmse_log1p': 0.7025775897799116, 'c1_loss': 0.2662177218214671, 'c2_loss': 0.30643690746837193}  |  val: {'rmse_km': 81.29881346189808, 'rmse_log1p': 0.7147971382995343, 'c1_bit_acc': 0.84290125, 'c2_bit_acc': 0.82919, 'c1_decoded_acc': 0.69312, 'c2_decoded_acc': 0.65464}
[157] train: {'loss': 1.0654134254964194, 'rmse_km': 73.86509821542919, 'rmse_log1p': 0.7019940075143082, 'c1_loss': 0.26619552293459575, 'c2_loss': 0.3064223882516225}  |  val: {'rmse_km': 77.55284236812342, 'rmse_log1p': 0.7147250467770014, 'c1_bit_acc': 0.843605, 'c2_bit_acc': 0.8273609375, 'c1_decoded_acc': 0.69219, 'c2_decoded_acc': 0.65203}
[158] train: {'loss': 1.067768268576728, 'rmse_km': 74.42589841895595, 'rmse_log1p': 0.7034522036994647, 'c1_loss': 0.26627300224198236, 'c2_loss': 0.3066502784930335}  |  val: {'rmse_km': 75.53812481642134, 'rmse_log1p': 0.7203393447077329, 'c1_bit_acc': 0.842655, 'c2_bit_acc': 0.82847, 'c1_decoded_acc': 0.69188, 'c2_decoded_acc': 0.65282}
[159] train: {'loss': 1.0693317659844292, 'rmse_km': 74.23483378357494, 'rmse_log1p': 0.7045168346453952, 'c1_loss': 0.26642556210305957, 'c2_loss': 0.3065621690018972}  |  val: {'rmse_km': 76.69755944617795, 'rmse_log1p': 0.7156936096218451, 'c1_bit_acc': 0.842521875, 'c2_bit_acc': 0.8298059375, 'c1_decoded_acc': 0.69101, 'c2_decoded_acc': 0.65561}
[160] train: {'loss': 1.066833478418986, 'rmse_km': 73.47191015640773, 'rmse_log1p': 0.7029269469330433, 'c1_loss': 0.26635231598854064, 'c2_loss': 0.3063748061879476}  |  val: {'rmse_km': 74.64493426172669, 'rmse_log1p': 0.7181179750794449, 'c1_bit_acc': 0.843665625, 'c2_bit_acc': 0.8288515625, 'c1_decoded_acc': 0.69266, 'c2_decoded_acc': 0.65385}
[161] train: {'loss': 1.066245164672004, 'rmse_km': 74.50857556034238, 'rmse_log1p': 0.7028977768701533, 'c1_loss': 0.2661865967686971, 'c2_loss': 0.30599320593516033}  |  val: {'rmse_km': 75.80256143635583, 'rmse_log1p': 0.7126752554197827, 'c1_bit_acc': 0.8444846875, 'c2_bit_acc': 0.8291896875, 'c1_decoded_acc': 0.69564, 'c2_decoded_acc': 0.65512}
[162] train: {'loss': 1.0605596156395807, 'rmse_km': 73.78759965794558, 'rmse_log1p': 0.699659922279079, 'c1_loss': 0.26549862907621596, 'c2_loss': 0.30553710675557455}  |  val: {'rmse_km': 75.61350635799135, 'rmse_log1p': 0.7205921697623652, 'c1_bit_acc': 0.8442403125, 'c2_bit_acc': 0.8274121875, 'c1_decoded_acc': 0.6935, 'c2_decoded_acc': 0.65244}
[163] train: {'loss': 1.0644317513571846, 'rmse_km': 73.44276576865825, 'rmse_log1p': 0.7019065047519623, 'c1_loss': 0.26581969376564024, 'c2_loss': 0.305939448917177}  |  val: {'rmse_km': 72.5292135377618, 'rmse_log1p': 0.7058638952012352, 'c1_bit_acc': 0.8436034375, 'c2_bit_acc': 0.828321875, 'c1_decoded_acc': 0.69355, 'c2_decoded_acc': 0.65083}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[164] train: {'loss': 1.0609435796737672, 'rmse_km': 73.51473996544843, 'rmse_log1p': 0.7000941119621127, 'c1_loss': 0.26543424868265786, 'c2_loss': 0.3053776596154107}  |  val: {'rmse_km': 75.54226815064365, 'rmse_log1p': 0.709239903159978, 'c1_bit_acc': 0.843974375, 'c2_bit_acc': 0.830841875, 'c1_decoded_acc': 0.69398, 'c2_decoded_acc': 0.65762}
[165] train: {'loss': 1.060532020111084, 'rmse_km': 74.77650293123503, 'rmse_log1p': 0.6999158953481407, 'c1_loss': 0.2653720012675391, 'c2_loss': 0.30527775396347046}  |  val: {'rmse_km': 73.80395603069832, 'rmse_log1p': 0.7129330139099275, 'c1_bit_acc': 0.842799375, 'c2_bit_acc': 0.8314015625, 'c1_decoded_acc': 0.69257, 'c2_decoded_acc': 0.6593}
[166] train: {'loss': 1.0652675216759575, 'rmse_km': 75.515649247358, 'rmse_log1p': 0.7027246395028326, 'c1_loss': 0.26580224832852684, 'c2_loss': 0.3056433477814992}  |  val: {'rmse_km': 84.47555350884065, 'rmse_log1p': 0.7123869906700013, 'c1_bit_acc': 0.8431853125, 'c2_bit_acc': 0.8293815625, 'c1_decoded_acc': 0.69241, 'c2_decoded_acc': 0.65454}
[167] train: {'loss': 1.0580988616434732, 'rmse_km': 74.62396944954249, 'rmse_log1p': 0.6987115522872345, 'c1_loss': 0.2649773768912421, 'c2_loss': 0.3049236025577121}  |  val: {'rmse_km': 78.89527770247089, 'rmse_log1p': 0.708270299201159, 'c1_bit_acc': 0.8425146875, 'c2_bit_acc': 0.8301465625, 'c1_decoded_acc': 0.69079, 'c2_decoded_acc': 0.65477}
[168] train: {'loss': 1.0567029757987128, 'rmse_km': 73.87421676297997, 'rmse_log1p': 0.6978584355406342, 'c1_loss': 0.26500868918418885, 'c2_loss': 0.3046879288005829}  |  val: {'rmse_km': 74.34629501213392, 'rmse_log1p': 0.7079191586467611, 'c1_bit_acc': 0.8440096875, 'c2_bit_acc': 0.8294696875, 'c1_decoded_acc': 0.69321, 'c2_decoded_acc': 0.65682}
[169] train: {'loss': 1.0590477163526748, 'rmse_km': 74.47363142310002, 'rmse_log1p': 0.6994148490877903, 'c1_loss': 0.26508549634827505, 'c2_loss': 0.30478094633102415}  |  val: {'rmse_km': 75.70338783494104, 'rmse_log1p': 0.7142212038200385, 'c1_bit_acc': 0.8418165625, 'c2_bit_acc': 0.83039625, 'c1_decoded_acc': 0.68886, 'c2_decoded_acc': 0.65781}
[170] train: {'loss': 1.058711813176473, 'rmse_km': 74.10672795978952, 'rmse_log1p': 0.6987900938429156, 'c1_loss': 0.2653480951383379, 'c2_loss': 0.30505614927079944}  |  val: {'rmse_km': 75.5296208967879, 'rmse_log1p': 0.7119184161603846, 'c1_bit_acc': 0.8440025, 'c2_bit_acc': 0.8285803125, 'c1_decoded_acc': 0.69456, 'c2_decoded_acc': 0.65525}
[171] train: {'loss': 1.0546163989893595, 'rmse_km': 73.60155876831007, 'rmse_log1p': 0.6970176576419144, 'c1_loss': 0.26464252177980213, 'c2_loss': 0.3041403673161401}  |  val: {'rmse_km': 83.38472699069357, 'rmse_log1p': 0.7041910778607191, 'c1_bit_acc': 0.8443128125, 'c2_bit_acc': 0.8315059375, 'c1_decoded_acc': 0.69459, 'c2_decoded_acc': 0.66126}
[172] train: {'loss': 1.0613652012761434, 'rmse_km': 73.7753961834923, 'rmse_log1p': 0.7007590436021832, 'c1_loss': 0.2654793812232547, 'c2_loss': 0.3048224558385213}  |  val: {'rmse_km': 78.97785426841976, 'rmse_log1p': 0.7141697942812911, 'c1_bit_acc': 0.84438375, 'c2_bit_acc': 0.8298278125, 'c1_decoded_acc': 0.69523, 'c2_decoded_acc': 0.65769}
[173] train: {'loss': 1.0572632041422525, 'rmse_km': 73.97509676510231, 'rmse_log1p': 0.6985969549185337, 'c1_loss': 0.2648445002047221, 'c2_loss': 0.3043809994973077}  |  val: {'rmse_km': 73.37140642818564, 'rmse_log1p': 0.7123335242285299, 'c1_bit_acc': 0.842608125, 'c2_bit_acc': 0.8303559375, 'c1_decoded_acc': 0.69037, 'c2_decoded_acc': 0.65772}
[174] train: {'loss': 1.0571700553470187, 'rmse_km': 74.64967334468885, 'rmse_log1p': 0.6985344548530529, 'c1_loss': 0.2648246073934767, 'c2_loss': 0.3043950768142276}  |  val: {'rmse_km': 77.53192386849433, 'rmse_log1p': 0.7157666445151536, 'c1_bit_acc': 0.8442084375, 'c2_bit_acc': 0.828595625, 'c1_decoded_acc': 0.69442, 'c2_decoded_acc': 0.65372}
[175] train: {'loss': 1.052383737894694, 'rmse_km': 74.56969658271046, 'rmse_log1p': 0.6960956149606093, 'c1_loss': 0.26419722608354357, 'c2_loss': 0.3036373998122745}  |  val: {'rmse_km': 75.60086456288876, 'rmse_log1p': 0.7156644602061802, 'c1_bit_acc': 0.8433790625, 'c2_bit_acc': 0.8307834375, 'c1_decoded_acc': 0.69309, 'c2_decoded_acc': 0.65812}
[176] train: {'loss': 1.0621537445407443, 'rmse_km': 74.68229911285036, 'rmse_log1p': 0.7017474561522188, 'c1_loss': 0.2652188628864288, 'c2_loss': 0.3044854487207201}  |  val: {'rmse_km': 77.52293007555893, 'rmse_log1p': 0.7098445245938837, 'c1_bit_acc': 0.843675, 'c2_bit_acc': 0.8303290625, 'c1_decoded_acc': 0.69256, 'c2_decoded_acc': 0.65766}
[177] train: {'loss': 1.0582117533153959, 'rmse_km': 73.91533704706521, 'rmse_log1p': 0.6996182413993035, 'c1_loss': 0.264679899037679, 'c2_loss': 0.3040661900806427}  |  val: {'rmse_km': 75.3032476163047, 'rmse_log1p': 0.7111673926600144, 'c1_bit_acc': 0.84499375, 'c2_bit_acc': 0.8309175, 'c1_decoded_acc': 0.69566, 'c2_decoded_acc': 0.65989}
[178] train: {'loss': 1.0517069177500407, 'rmse_km': 73.29330591129214, 'rmse_log1p': 0.6956848690458548, 'c1_loss': 0.26418847882482743, 'c2_loss': 0.30354088937547474}  |  val: {'rmse_km': 72.21216434706483, 'rmse_log1p': 0.7034247924863493, 'c1_bit_acc': 0.84436875, 'c2_bit_acc': 0.83138875, 'c1_decoded_acc': 0.69418, 'c2_decoded_acc': 0.65947}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[179] train: {'loss': 1.0476636960601806, 'rmse_km': 73.79547062235595, 'rmse_log1p': 0.6934190966178434, 'c1_loss': 0.2638165474489, 'c2_loss': 0.30301716420279606}  |  val: {'rmse_km': 76.20096399693708, 'rmse_log1p': 0.7122866645794299, 'c1_bit_acc': 0.8439421875, 'c2_bit_acc': 0.8299221875, 'c1_decoded_acc': 0.69453, 'c2_decoded_acc': 0.65563}
[180] train: {'loss': 1.05093619108412, 'rmse_km': 72.91430650942242, 'rmse_log1p': 0.6956197724055951, 'c1_loss': 0.26397243785328334, 'c2_loss': 0.3030769837019179}  |  val: {'rmse_km': 72.68470880818916, 'rmse_log1p': 0.7042179302501118, 'c1_bit_acc': 0.8462940625, 'c2_bit_acc': 0.831469375, 'c1_decoded_acc': 0.69807, 'c2_decoded_acc': 0.66107}
[181] train: {'loss': 1.0516572391255696, 'rmse_km': 73.96177222051944, 'rmse_log1p': 0.6960809083518299, 'c1_loss': 0.26411686407089235, 'c2_loss': 0.3030117243300544}  |  val: {'rmse_km': 74.15627304571913, 'rmse_log1p': 0.7062047479698941, 'c1_bit_acc': 0.8450034375, 'c2_bit_acc': 0.8302946875, 'c1_decoded_acc': 0.69623, 'c2_decoded_acc': 0.65766}
[182] train: {'loss': 1.047127335442437, 'rmse_km': 74.41715257691772, 'rmse_log1p': 0.6934987102790837, 'c1_loss': 0.26359779783354864, 'c2_loss': 0.3025889392789205}  |  val: {'rmse_km': 73.51329200602092, 'rmse_log1p': 0.7064840823443632, 'c1_bit_acc': 0.84476125, 'c2_bit_acc': 0.8309890625, 'c1_decoded_acc': 0.6944, 'c2_decoded_acc': 0.66003}
[183] train: {'loss': 1.049127706726922, 'rmse_km': 73.6900345461057, 'rmse_log1p': 0.6948133026788221, 'c1_loss': 0.26372195895195005, 'c2_loss': 0.3026403896882799}  |  val: {'rmse_km': 75.28456107807729, 'rmse_log1p': 0.7036694855647846, 'c1_bit_acc': 0.845425, 'c2_bit_acc': 0.83080625, 'c1_decoded_acc': 0.69628, 'c2_decoded_acc': 0.65951}
[184] train: {'loss': 1.0497885299852159, 'rmse_km': 75.04019756104057, 'rmse_log1p': 0.6950221151840162, 'c1_loss': 0.2639889513354831, 'c2_loss': 0.30274395020167033}  |  val: {'rmse_km': 74.24190428297553, 'rmse_log1p': 0.7066806956876476, 'c1_bit_acc': 0.84483, 'c2_bit_acc': 0.83106375, 'c1_decoded_acc': 0.69472, 'c2_decoded_acc': 0.65917}
[185] train: {'loss': 1.0504617329321968, 'rmse_km': 73.77820236717109, 'rmse_log1p': 0.6955358382301353, 'c1_loss': 0.2638074136575063, 'c2_loss': 0.30288414025306704}  |  val: {'rmse_km': 78.26092238567247, 'rmse_log1p': 0.710713822945898, 'c1_bit_acc': 0.84345875, 'c2_bit_acc': 0.8305609375, 'c1_decoded_acc': 0.69213, 'c2_decoded_acc': 0.65658}
[186] train: {'loss': 1.051271246922811, 'rmse_km': 73.74024034999479, 'rmse_log1p': 0.6960645530391592, 'c1_loss': 0.2639338352563646, 'c2_loss': 0.3028316166888343}  |  val: {'rmse_km': 73.93790284125254, 'rmse_log1p': 0.696334494971747, 'c1_bit_acc': 0.84491, 'c2_bit_acc': 0.831985, 'c1_decoded_acc': 0.69604, 'c2_decoded_acc': 0.66068}
[187] train: {'loss': 1.0414357989756267, 'rmse_km': 73.10231018173263, 'rmse_log1p': 0.6904689880149691, 'c1_loss': 0.2629270683818393, 'c2_loss': 0.30176138758765325}  |  val: {'rmse_km': 76.57119529704855, 'rmse_log1p': 0.7024118833835722, 'c1_bit_acc': 0.845235, 'c2_bit_acc': 0.83177875, 'c1_decoded_acc': 0.69668, 'c2_decoded_acc': 0.66016}
[188] train: {'loss': 1.0458608822250366, 'rmse_km': 74.01702520049864, 'rmse_log1p': 0.6932088554228873, 'c1_loss': 0.2633475031630198, 'c2_loss': 0.30197491237746343}  |  val: {'rmse_km': 76.21657182209456, 'rmse_log1p': 0.7042025045345485, 'c1_bit_acc': 0.844476875, 'c2_bit_acc': 0.8317784375, 'c1_decoded_acc': 0.69343, 'c2_decoded_acc': 0.66167}
[189] train: {'loss': 1.0485901825120714, 'rmse_km': 74.51553162344747, 'rmse_log1p': 0.6949269586712745, 'c1_loss': 0.2634768245580461, 'c2_loss': 0.3021897308943007}  |  val: {'rmse_km': 75.97091600161868, 'rmse_log1p': 0.7198255618368414, 'c1_bit_acc': 0.8443721875, 'c2_bit_acc': 0.830679375, 'c1_decoded_acc': 0.69463, 'c2_decoded_acc': 0.65919}
[190] train: {'loss': 1.04722187084198, 'rmse_km': 73.85608432218872, 'rmse_log1p': 0.6941762920397702, 'c1_loss': 0.26335074980311923, 'c2_loss': 0.30199038499514264}  |  val: {'rmse_km': 71.69315651724543, 'rmse_log1p': 0.7096000919240916, 'c1_bit_acc': 0.84564, 'c2_bit_acc': 0.831348125, 'c1_decoded_acc': 0.69812, 'c2_decoded_acc': 0.65952}
  ↳ saved checkpoint: python/nn_checkpoints/siren_ecoc_1M_15x128_0h_w30.0_bayes_thr.pt
[191] train: {'loss': 1.0444645286051433, 'rmse_km': 72.89336979022852, 'rmse_log1p': 0.6924426183441669, 'c1_loss': 0.2632322714477115, 'c2_loss': 0.3017554579141405}  |  val: {'rmse_km': 77.80940945167718, 'rmse_log1p': 0.7043482418444282, 'c1_bit_acc': 0.8463415625, 'c2_bit_acc': 0.8316346875, 'c1_decoded_acc': 0.69847, 'c2_decoded_acc': 0.66078}
[192] train: {'loss': 1.0443694683795506, 'rmse_km': 74.03967541228317, 'rmse_log1p': 0.692482105877767, 'c1_loss': 0.26310993556340534, 'c2_loss': 0.30172810746616785}  |  val: {'rmse_km': 77.71432687453775, 'rmse_log1p': 0.7007924703084645, 'c1_bit_acc': 0.8455728125, 'c2_bit_acc': 0.8318696875, 'c1_decoded_acc': 0.69734, 'c2_decoded_acc': 0.66204}
[193] train: {'loss': 1.0418080231984457, 'rmse_km': 74.04199676640447, 'rmse_log1p': 0.6910402223512332, 'c1_loss': 0.2628122012763553, 'c2_loss': 0.30145931035253737}  |  val: {'rmse_km': 72.63049274624605, 'rmse_log1p': 0.6975927146695798, 'c1_bit_acc': 0.8460021875, 'c2_bit_acc': 0.8323525, 'c1_decoded_acc': 0.69798, 'c2_decoded_acc': 0.66089}
[194] train: {'loss': 1.0411094676038954, 'rmse_km': 74.64518283394113, 'rmse_log1p': 0.6906480457379061, 'c1_loss': 0.26279447618272567, 'c2_loss': 0.30132032859696284}  |  val: {'rmse_km': 75.14653328559974, 'rmse_log1p': 0.7048134135147078, 'c1_bit_acc': 0.844193125, 'c2_bit_acc': 0.83255625, 'c1_decoded_acc': 0.69539, 'c2_decoded_acc': 0.6627}
[195] train: {'loss': 1.0440748291100397, 'rmse_km': 74.04774708022013, 'rmse_log1p': 0.6926752288097641, 'c1_loss': 0.2628015497133467, 'c2_loss': 0.3014743878979153}  |  val: {'rmse_km': 74.12492095274031, 'rmse_log1p': 0.7090943726680659, 'c1_bit_acc': 0.843219375, 'c2_bit_acc': 0.8312959375, 'c1_decoded_acc': 0.69187, 'c2_decoded_acc': 0.65899}
[196] train: {'loss': 1.0409721119859483, 'rmse_km': 74.06282304781867, 'rmse_log1p': 0.6910882207626439, 'c1_loss': 0.2624492414220174, 'c2_loss': 0.3009200044992235}  |  val: {'rmse_km': 76.5765325150679, 'rmse_log1p': 0.7054184279970944, 'c1_bit_acc': 0.8457840625, 'c2_bit_acc': 0.830111875, 'c1_decoded_acc': 0.69721, 'c2_decoded_acc': 0.65796}
[197] train: {'loss': 1.0420525799391005, 'rmse_km': 73.26096134389208, 'rmse_log1p': 0.6915172121480685, 'c1_loss': 0.2627195272201962, 'c2_loss': 0.3011370071146223}  |  val: {'rmse_km': 72.61198248223222, 'rmse_log1p': 0.7078798375719695, 'c1_bit_acc': 0.8458690625, 'c2_bit_acc': 0.831889375, 'c1_decoded_acc': 0.6976, 'c2_decoded_acc': 0.66004}
[198] train: {'loss': 1.0383426864454481, 'rmse_km': 73.40913680998776, 'rmse_log1p': 0.689621383408589, 'c1_loss': 0.2621720512591468, 'c2_loss': 0.30059309773974946}  |  val: {'rmse_km': 77.74286228792165, 'rmse_log1p': 0.7111195760792656, 'c1_bit_acc': 0.8457109375, 'c2_bit_acc': 0.831088125, 'c1_decoded_acc': 0.69722, 'c2_decoded_acc': 0.65873}
[199] train: {'loss': 1.0447520874786378, 'rmse_km': 73.78544897517904, 'rmse_log1p': 0.6931579727159011, 'c1_loss': 0.2629195039643182, 'c2_loss': 0.3013645777522193}  |  val: {'rmse_km': 75.58322386924726, 'rmse_log1p': 0.7039006299674089, 'c1_bit_acc': 0.846086875, 'c2_bit_acc': 0.8293425, 'c1_decoded_acc': 0.69753, 'c2_decoded_acc': 0.65546}
[200] train: {'loss': 1.038472069261339, 'rmse_km': 73.6056585375744, 'rmse_log1p': 0.6893375721348584, 'c1_loss': 0.2625500024339888, 'c2_loss': 0.3007356566153632}  |  val: {'rmse_km': 74.84246149725936, 'rmse_log1p': 0.700432539035183, 'c1_bit_acc': 0.845749375, 'c2_bit_acc': 0.8314734375, 'c1_decoded_acc': 0.6976, 'c2_decoded_acc': 0.66005}'''


#losses = extract_and_plot_train_losses(printout)
#print(losses)


def neuron_counter(in_dim = 3, layer_counts: tuple = (256,)*5, head_counts = (), d_out = 1, c1_out = 32, c2_out = 32):
    depth = len(layer_counts)
    total = (in_dim+1) * layer_counts[0] 
    for i in range(1, depth):
        total += (layer_counts[i-1]+1) * layer_counts[i] 

    head_counts = (layer_counts[-1],) + head_counts
    for i in range(1, len(head_counts)):
        total += 3*(head_counts[i-1]+1) * head_counts[i]
    total += head_counts[-1] * (d_out + c1_out + c2_out)
    
    return f"n: {total} | {round(total*0.000004, 2)} mb" 

width = 256
depth = 5
print(neuron_counter(
    layer_counts=(width,)*depth
    #, head_counts=(width,)
    ))